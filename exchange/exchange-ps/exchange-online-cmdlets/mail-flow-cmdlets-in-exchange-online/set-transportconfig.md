---
title: "Set-TransportConfig"
ms.author: chrisda
author: chrisda
manager: serdars
ms.date: 1/16/2018
ms.audience: Admin
ms.topic: reference
ms.service: exchange-online
localization_priority: Normal
ms.assetid: ad3910a5-2227-47a2-8ccc-a208ce6210bb
description: "This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other."
---

# Set-TransportConfig

This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other. 
  
Use the **Set-TransportConfig** cmdlet to modify the transport configuration settings for the whole Exchange organization.
  
```
Set-TransportConfig [-Identity <OrganizationIdParameter>] [-AddressBookPolicyRoutingEnabled <$true | $false>] [-AgentGeneratedMessageLoopDetectionInSmtpEnabled <$true | $false>] [-AgentGeneratedMessageLoopDetectionInSubmissionEnabled <$true | $false>] [-ClearCategories <$true | $false>] [-Confirm [<SwitchParameter>]] [-ConvertDisclaimerWrapperToEml <$true | $false>] [-DiagnosticsAggregationServicePort <Int32>] [-DomainController <Fqdn>] [-DSNConversionMode <UseExchangeDSNs | PreserveDSNBody | DoNotConvert>] [-ExternalDelayDsnEnabled <$true | $false>] [-ExternalDsnDefaultLanguage <CultureInfo>] [-ExternalDsnLanguageDetectionEnabled <$true | $false>] [-ExternalDsnMaxMessageAttachSize <ByteQuantifiedSize>] [-ExternalDsnReportingAuthority <SmtpDomain>] [-ExternalDsnSendHtml <$true | $false>] [-ExternalPostmasterAddress <SmtpAddress>] [-Force <SwitchParameter>] [-GenerateCopyOfDSNFor <MultiValuedProperty>] [-HeaderPromotionModeSetting <NoCreate | MayCreate | MustCreate>] [-InternalDelayDsnEnabled <$true | $false>] [-InternalDsnDefaultLanguage <CultureInfo>] [-InternalDsnLanguageDetectionEnabled <$true | $false>] [-InternalDsnMaxMessageAttachSize <ByteQuantifiedSize>] [-InternalDsnReportingAuthority <SmtpDomain>] [-InternalDsnSendHtml <$true | $false>] [-InternalSMTPServers <MultiValuedProperty>] [-JournalingReportNdrTo <SmtpAddress>] [-JournalReportDLMemberSubstitutionEnabled <$true | $false>] [-MaxAllowedAgentGeneratedMessageDepth <UInt32>] [-MaxAllowedAgentGeneratedMessageDepthPerAgent <UInt32>] [-MaxDumpsterSizePerDatabase <ByteQuantifiedSize>] [-MaxDumpsterTime <EnhancedTimeSpan>] [-MaxReceiveSize <Unlimited>] [-MaxRecipientEnvelopeLimit <Unlimited>] [-MaxRetriesForLocalSiteShadow <Int32>] [-MaxRetriesForRemoteSiteShadow <Int32>] [-MaxSendSize <Unlimited>] [-QueueDiagnosticsAggregationInterval <EnhancedTimeSpan>] [-RejectMessageOnShadowFailure <$true | $false>] [-Rfc2231EncodingEnabled <$true | $false>] [-SafetyNetHoldTime <EnhancedTimeSpan>] [-ShadowHeartbeatFrequency <EnhancedTimeSpan>] [-ShadowHeartbeatRetryCount <Int32>] [-ShadowHeartbeatTimeoutInterval <EnhancedTimeSpan>] [-ShadowMessageAutoDiscardInterval <EnhancedTimeSpan>] [-ShadowMessagePreferenceSetting <PreferRemote | LocalOnly | RemoteOnly>] [-ShadowRedundancyEnabled <$true | $false>] [-ShadowResubmitTimeSpan <EnhancedTimeSpan>] [-SmtpClientAuthenticationDisabled <$true | $false>] [-SupervisionTags <MultiValuedProperty>] [-TLSReceiveDomainSecureList <MultiValuedProperty>] [-TLSSendDomainSecureList <MultiValuedProperty>] [-TransportRuleAttachmentTextScanLimit <ByteQuantifiedSize>] [-VerifySecureSubmitEnabled <$true | $false>] [-VoicemailJournalingEnabled <$true | $false>] [-WhatIf [<SwitchParameter>]] [-Xexch50Enabled <$true | $false>]

```

## Examples
<a name="Examples"> </a>

### Example 1

This example configures the Exchange organization to forward all DSN messages that have the DSN codes 5.7.1, 5.7.2, and 5.7.3 to the postmaster email account.
  
```
Set-TransportConfig -GenerateCopyOfDSNFor 5.7.1,5.7.2,5.7.3
```

### Example 2

This example configures the Exchange organization to redirect all journaling reports that can't be delivered to the journaling mailbox to the email account  `journalingndr@contoso.com`.
  
```
Set-TransportConfig -JournalingReportNdrTo journalingndr@contoso.com
```

> [!NOTE]
> To avoid journaling issues, we recommend that you set  _JournalingReportNdrTo_ to a dedicated mailbox without any transport rule or mailbox rule. Or, set _JournalingReportNdrTo_ to an external address. In Exchange Online, you can configure this setting by using the Office 365 portal or Exchange Online PowerShell. In on-premises Exchange Server, you can configure this setting by using the Exchange Management Shell. For more information, see[Transport and Mailbox rules in Exchange Online or in on-premises Exchange Server don't work as expected](http://go.microsoft.com/fwlink/?LinkID=787472&amp;clcid=0x409). 
  
## Detailed Description
<a name="DetailedDescription"> </a>

You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://technet.microsoft.com/library/mt432940.aspx).
  
## Parameters
<a name="DetailedDescription"> </a>

|**Parameter**|**Required**|**Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _AddressBookPolicyRoutingEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _AddressBookPolicyRoutingEnabled_ parameter controls how recipients are resolved in an organization that uses address book policies to create separate virtual organizations within the same Exchange organization. Specifically, the global address list (GAL) that's specified in the user's address book policy controls how recipients are resolved. When the value of this parameter is `$true`, users that are assigned different GALs appear as external recipients. When the value of this parameter is  `$false`, users that are assigned different GALs appear as internal recipients.  <br/> The default value is  `$false`. Note that this parameter has no effect if your organization doesn't use address book policies, or if the address book policy routing agent isn't installed and enabled. Also note that changing the value of this parameter may take up to 30 minutes to take effect. For more information about address book policies, see [Address Book Policies](http://technet.microsoft.com/library/d0a916a1-e3ed-49ae-b116-a559be0dcce6.aspx).  <br/> |
| _AgentGeneratedMessageLoopDetectionInSmtpEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _AgentGeneratedMessageLoopDetectionInSmtpEnabled_ parameter controls the behavior of messages loop detection in for loops caused by transport agents in the Transport service. An agent-generated loop occurs when an agent creates a new copy of a message or adds recipients to a message, and the agent continues to process these resulting messages by creating copies or adding recipients. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> When Exchange detects an agent-generated message loop, the loop is stopped. When this parameter is set to  `$false`, the loop is logged in the message tracking log. When this parameter is set to  `$true`, the message is rejected with an NDR when the loop generates the number of messages specified by the  _MaxAllowedAgentGeneratedMessageDepth_ and _MaxAllowedAgentGeneratedMessageDepthPerAgent_ parameters. <br/> |
| _AgentGeneratedMessageLoopDetectionInSubmissionEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _AgentGeneratedMessageLoopDetectionInSubmissionEnabled_ parameter controls the behavior of messages loop detection in for loops caused by transport agents in the Mailbox Transport Submission service. An agent-generated loop occurs when an agent creates a new copy of a message or adds recipients to a message, and the agent continues to process these resulting messages by creating copies or adding recipients. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> When Exchange detects an agent-generated message loop, the loop is stopped. When this parameter is set to  `$true`, the loop is logged in the message tracking log. When this parameter is set to  `$false`, the message is rejected with an NDR when the loop generates the number of messages specified by the  _MaxAllowedAgentGeneratedMessageDepthPerAgent_ and _MaxAllowedAgentGeneratedMessageDepth_ parameters. <br/> |
| _ClearCategories_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _ClearCategories_ parameter keeps or removes Microsoft Outlook message categories during content conversion. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`. This means that by default, Outlook message categories are removed during content conversion.  <br/> |
| _Confirm_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Confirm_ switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding. <br/>  Destructive cmdlets (for example, **Remove-\*** cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.  <br/>  Most other cmdlets (for example, **New-\*** and **Set-\*** cmdlets) don't have a built-in pause. For these cmdlets, specifying the _Confirm_ switch without a value introduces a pause that forces you acknowledge the command before proceeding. <br/> |
| _ConvertDisclaimerWrapperToEml_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _ConvertDisclaimerWrapperToEml_ parameter specifies whether the original message will be added as a TNEF attachment or a regular EML attachment to a disclaimer when all of the following are true: <br/>  Message is sent to an external user. <br/>  The sender has signed the message. <br/>  The message is processed by a Transport rule that adds a disclaimer. <br/>  When a Transport rule that adds disclaimers to outbound messages encounters a message signed by the sender, the Transport rule can't add the disclaimer directly to the message. As a result, the disclaimer is sent to the intended recipient with the original message as an attachment. <br/>  Valid input for this parameter is `$true` or `$false`. The default value is  `$false`. If you set this parameter to  `$true`, the original message is sent as an EML attachment. Otherwise, it is sent as a TNEF attachment.  <br/> |
| _DiagnosticsAggregationServicePort_ <br/> |Optional  <br/> |System.Int32  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _DiagnosticsAggregationServicePort_ parameter specifies the TCP port that's used to collect message queue diagnostic information. The default value is 9710. <br/> |
| _DomainController_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _DomainController_ parameter specifies the domain controller that's used by this cmdlet to read data from or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN). For example, `dc01.contoso.com`.  <br/> The  _DomainController_ parameter isn't supported on Edge Transport servers. An Edge Transport server uses the local instance of Active Directory Lightweight Directory Services (AD LDS) to read and write data. <br/> |
| _DSNConversionMode_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.DSNConversionOption  <br/> | The _DSNConversionMode_ parameter controls how Exchange handles delivery status notifications (also known as DSNs, non-delivery reports, NDRs, or bounce messages) that are generated by earlier versions of Exchange or other messaging systems. Valid values are: <br/>  `DoNotConvert`: DSNs aren't modified. The DSN is delivered as a standard message.  <br/>  `PreserveDSNBody`: DSNs are converted to the Exchange 2010 or later format, and the text in the body of the DSN message is retained. This is the default value.  <br/>  `UseExchangeDSNs`: DSNs are converted to the Exchange 2010 or later format. However, any customized text or attachments that were associated with the original DSN are overwritten.  <br/> |
| _ExternalDelayDsnEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _ExternalDelayDsnEnabled_ parameter specifies whether a delay delivery status notification (DSN) message should be created for external messages that couldn't be immediately delivered. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
| _ExternalDsnDefaultLanguage_ <br/> |Optional  <br/> |System.Globalization.CultureInfo  <br/> |The  _ExternalDsnDefaultLanguage_ parameter specifies which Exchange server language should be used by default when you create external DSN messages. The default value is the default Windows server language. <br/> |
| _ExternalDsnLanguageDetectionEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _ExternalDsnLanguageDetectionEnabled_ parameter specifies whether the server should try to send an external DSN message in the same language as the original message that generated the notification. Valid input for this parameter is `$true` or `$false`.The default value is  `$true`.  <br/> |
| _ExternalDsnMaxMessageAttachSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | The _ExternalDsnMaxMessageAttachSize_ parameter specifies the maximum size of the original message attached to an external DSN message. If the original message exceeds this size, only the headers of the original message are included in the DSN message. The default value is 10 megabytes (MB). <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  The valid input range for this parameter is from 0 through 2147483647 bytes. If you specify a value of 0, only the original message headers are included in the external DSN message. <br/> |
| _ExternalDsnReportingAuthority_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpDomain  <br/> |The  _ExternalDsnReportingAuthority_ parameter specifies what the server name should be in the machine-readable part of the external DSN message. The default value is the authoritative domain specified during installation. <br/> |
| _ExternalDsnSendHtml_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _ExternalDsnSendHtml_ parameter specifies whether external DSN messages should be sent by using HTML or whether messages should be sent in plain text. Valid input for this parameter is `$true` or `$false`.The default value is  `$true`.  <br/> |
| _ExternalPostmasterAddress_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpAddress  <br/> |The  _ExternalPostmasterAddress_ parameter specifies the email address in the `From` header field of an external DSN message. The default value is `$null`. In the Transport service on a Mailbox server, the value of the external postmaster email address is  `postmaster@<defaultaccepteddomain>`. If an Edge Transport server hasn't yet been through the EdgeSync process, and the  _ExternalPostmasterAddress_ parameter is set to `$null`, the external postmaster email address on the Edge Transport server is  `postmaster@<edgetransportserverfqdn>`. If an Edge Transport server has completed the EdgeSync process, and the  _ExternalPostmasterAddress_ parameter is set to `$null`, the external postmaster email address on the Edge Transport server is  `postmaster@<defaultaccepteddomain>`. To override the default behavior, you can specify an email address for the  _ExternalPostMasterAddress_ parameter. <br/> |
| _Force_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The  _Force_ switch specifies whether to suppress warning or confirmation messages. You can use this switch to run tasks programmatically where prompting for administrative input is inappropriate. You don't need to specify a value with this switch. <br/> |
| _GenerateCopyOfDSNFor_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _GenerateCopyOfDSNFor_ parameter controls the non-delivery reports (NDRs) that are copied to a mailbox by specifying the DSN codes that you want to monitor. You must configure the list of monitored DSNs on one Mailbox server and locally on each Edge Transport server in your Exchange organization. <br/>  On a Mailbox server, NDRs are copied to the mailbox assigned to the Exchange recipient. On Edge Transport servers, NDRs are copied to the mailbox assigned to the external postmaster address. <br/>  DSN codes are entered as _x.y.z_ and are separated by commas. By default, the following DSN codes are monitored: <br/>  5.4.8 <br/>  5.4.6 <br/>  5.4.4 <br/>  5.2.4 <br/>  5.2.0 <br/>  5.1.4 <br/>  To enter multiple values and overwrite any existing entries, use the following syntax: `<value1>,<value2>...`. If the values contain spaces or otherwise require quotation marks, you need to use the following syntax:  `"<value1>","<value2>"...`.  <br/>  To add or remove one or more values without affecting any existing entries, use the following syntax: `@{Add="<value1>","<value2>"...; Remove="<value1>","<value2>"...}`.  <br/>  Although these DSN codes are monitored by default, the associated NDRs aren't copied to the Exchange recipient or to the external postmaster address if no mailbox is assigned to the Exchange recipient or to the external postmaster address. By default, no mailbox is assigned to the Exchange recipient or to the external postmaster address. <br/>  To assign a mailbox to the Exchange recipient, use the **Set-OrganizationConfig** cmdlet with the _MicrosoftExchangeRecipientReplyRecipient_ parameter. To assign a mailbox to the external postmaster address, create a new mailbox postmaster. The default email address policy of the Exchange organization should automatically add an SMTP address of postmaster@< _Authoritative domain_> to the mailbox.  <br/> |
| _HeaderPromotionModeSetting_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderPromotionMode  <br/> | The _HeaderPromotionModeSetting_ parameter specifies whether named properties are created for custom X-headers on messages received from outside the Exchange organization. You can use one of the following values: <br/>  `MustCreate`: Exchange creates a named property for each new custom X-header.  <br/>  `MayCreate`: Exchange creates a named property for each new custom X-header on messages received from authenticated senders. No named properties are created for custom X-headers on messages received from unauthenticated senders.  <br/>  `NoCreate`: Exchange won't create any named properties based on custom X-headers on incoming messages.  <br/> |
| _Identity_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.OrganizationIdParameter  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _InternalDelayDsnEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _InternalDelayDsnEnabled_ parameter specifies whether a delay DSN message should be created for messages sent to or from recipients or senders in the same Exchange organization that couldn't be immediately delivered. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
| _InternalDsnDefaultLanguage_ <br/> |Optional  <br/> |System.Globalization.CultureInfo  <br/> |The  _InternalDsnDefaultLanguage_ parameter specifies which Exchange server language should be used by default when you create internal DSN messages. The default value is the default Windows server language. <br/> |
| _InternalDsnLanguageDetectionEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _InternalDsnLanguageDetectionEnabled_ parameter specifies whether the server should try to send an internal DSN message in the same language as the original message that generated the notification. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
| _InternalDsnMaxMessageAttachSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | The _InternalDsnMaxMessageAttachSize_ parameter specifies the maximum size of the original message that generated an internal DSN message. If the original message exceeds this size, only the headers of the original message are included in the DSN message. The default value is 10 MB. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  The valid input range for this parameter is from 0 through 2147483647 bytes. If you specify a value of 0, only the original message headers are included in the internal DSN message. <br/> |
| _InternalDsnReportingAuthority_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpDomain  <br/> |The  _InternalDsnReportingAuthority_ parameter specifies what the server name should be in the internal DSN message. The default value is the authoritative domain specified during installation. <br/> |
| _InternalDsnSendHtml_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _InternalDsnSendHtml_ parameter specifies whether internal DSN messages should be sent by using HTML or whether messages should be sent in plain text. Valid input for this parameter is `$true` or `$false`. The default is  `$true`.  <br/> |
| _InternalSMTPServers_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _InternalSMTPServers_ parameter specifies a list of internal SMTP server IP addresses or IP address ranges that should be ignored by Sender ID and connection filtering. <br/> To enter multiple values and overwrite any existing entries, use the following syntax:  `<value1>,<value2>...`. If the values contain spaces or otherwise require quotation marks, you need to use the following syntax:  `"<value1>","<value2>"...`.  <br/> To add or remove one or more values without affecting any existing entries, use the following syntax:  `@{Add="<value1>","<value2>"...; Remove="<value1>","<value2>"...}`.  <br/> |
| _JournalingReportNdrTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpAddress  <br/> |The  _JournalingReportNdrTo_ parameter specifies the email address to which journal reports are sent if the journaling mailbox is unavailable. By default, if this parameter is left empty, Exchange continues to try to deliver the journal report to the journaling mailbox. We recommended that you use a dedicated (non-user) mailbox as the argument to _JournalingReportNdrTo_.  <br/> |
| _JournalReportDLMemberSubstitutionEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _MaxAllowedAgentGeneratedMessageDepth_ <br/> |Optional  <br/> |System.UInt32  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _MaxAllowedAgentGeneratedMessageDepth_ parameter specifies how many times all agents can process any resulting copies of the same message. The default value is 3. Valid input for this parameter is an integer. <br/> |
| _MaxAllowedAgentGeneratedMessageDepthPerAgent_ <br/> |Optional  <br/> |System.UInt32  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _MaxAllowedAgentGeneratedMessageDepthPerAgent_ parameter specifies how many times a single agent can process any resulting copies of the same message. The default value is 2. <br/> The value of the  _MaxAllowedAgentGeneratedMessageDepth_ parameter should be larger than the value of the _MaxAllowedAgentGeneratedMessageDepthPerAgent_ parameter. <br/> |
| _MaxDumpsterSizePerDatabase_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter is available only in on-premises Exchange. <br/>  This parameter isn't used by Microsoft Exchange Server 2016. It's only used by Microsoft Exchange 2010 servers in a coexistence environment. <br/>  The _MaxDumpsterSizePerDatabase_ parameter specifies the maximum size of the transport dumpster on a Hub Transport server for each database. The default value is 18 MB. The valid input range for this parameter is from 0 through 2147483647 KB. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  To enable the transport dumpster, the value of the _MaxDumpsterSizePerDatabase_ parameter must be greater than 0, and the value of the _MaxDumpsterTime_ parameter must be greater than `00:00:00`.  <br/>  There's no replacement for this parameter in later versions of Exchange. <br/> |
| _MaxDumpsterTime_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> This parameter isn't used by Microsoft Exchange Server 2016. It's only used by Microsoft Exchange 2010 servers in a coexistence environment.  <br/> The  _MaxDumpsterTime_ parameter specifies how long an email message should remain in the transport dumpster on a Hub Transport server. The default value is seven days. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> For example, to specify 10 days for this parameter, use 10.00:00:00. The valid input range for this parameter is 00:00:00 to 24855.03:14:07.  <br/> To enable the transport dumpster, the value of the  _MaxDumpsterSizePerStorageGroup_ parameter must be greater than 0, and the value of the _MaxDumpsterTime_ parameter must be greater than 00:00:00. <br/> This parameter is replaced by the  _SafetyNetHoldTime_ parameter. <br/> |
| _MaxReceiveSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _MaxReceiveSize_ parameter specifies the maximum message size that can be received by recipients in the organization. The default value is 10 MB. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  The valid input range for this parameter is from 0 through 2097151 KB. If you enter a value of `Unlimited`, no limit is imposed on the message size that can be received by recipients in the organization.  <br/> |
| _MaxRecipientEnvelopeLimit_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _MaxRecipientEnvelopeLimit_ parameter specifies the maximum number of recipients in a message. The default value is 5000. The valid input range for this parameter is from 0 through 2147483647. If you enter a value of `Unlimited`, no limit is imposed on the number of recipients in a message. Exchange treats an unexpanded distribution group as one recipient.  <br/> |
| _MaxRetriesForLocalSiteShadow_ <br/> |Optional  <br/> |System.Int32  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _MaxRetriesForLocalSiteShadow_ parameter specifies the maximum number of attempts to make a shadow copy of the message in the local Active Directory site. Valid input for this parameter is an integer between 0 and 255. The default value is 2. The total number of attempts to create a shadow copy of the message is controlled by the _ShadowMessagePreferenceSetting_ parameter: <br/>  If _ShadowMessagePreferenceSetting_ is set to `LocalOnly`, the total number of attempts to make a shadow copy of the message is the value of the  _MaxRetriesForLocalSiteShadow_ parameter. <br/>  If _ShadowMessagePreferenceSetting_ is set to `PreferRemote`, the total number of attempts to make a shadow copy of the message is the value of the  _MaxRetriesForLocalSiteShadow_ and _MaxRetriesForRemoteSiteShadow_ parameters added together. <br/>  If _ShadowMessagePreferenceSetting_ is set to `RemoteOnly`, the value of  _MaxRetriesForLocalSiteShadow_ is 0, and the _MaxRetriesForLocalSiteShadow_ parameter has no effect on the total number of attempts to create a shadow copy of the message. <br/>  If a shadow copy of the message isn't created after the specified number of attempts, accepting or rejecting the message is controlled by the _RejectMessageOnShadowFailure_ parameter. <br/> |
| _MaxRetriesForRemoteSiteShadow_ <br/> |Optional  <br/> |System.Int32  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _MaxRetriesForRemoteSiteShadow_ parameter specifies the maximum number of attempts to make a shadow copy of the message in a different Active Directory site. Valid input for this parameter is an integer between 0 and 255. The default value is 4. The total number of attempts to create a shadow copy of the message is controlled by the _ShadowMessagePreferenceSetting_ parameter: <br/>  If _ShadowMessagePreferenceSetting_ is set to `RemoteOnly`, the total number of attempts to make a shadow copy of the message is the value of the  _MaxRetriesForRemoteSiteShadow_ parameter. <br/>  If _ShadowMessagePreferenceSetting_ is set to `PreferRemote`, the total number of attempts to make a shadow copy of the message is the value of the  _MaxRetriesForLocalSiteShadow_ and _MaxRetriesForRemoteSiteShadow_ parameters added together. <br/>  If _ShadowMessagePreferenceSetting_ is set to `LocalOnly`, the value of  _MaxRetriesForRemoteSiteShadow_ is 0, and the _MaxRetriesForRemoteSiteShadow_ parameter has no effect on the total number of attempts to create a shadow copy of the message. <br/>  If a shadow copy of the message isn't created after the specified number of attempts, accepting or rejecting the message is controlled by the _RejectMessageOnShadowFailure_ parameter. <br/> |
| _MaxSendSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _MaxSendSize_ parameter specifies the maximum message size that can be sent by senders in the organization. The default value is 10 MB. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  The valid input range for this parameter is from 0 through 2097151 KB. If you enter a value of `Unlimited`, no limit is imposed on the message size that can be sent by senders in the organization.  <br/> |
| _QueueDiagnosticsAggregationInterval_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _QueueDiagnosticsAggregationInterval_ parameter specifies the polling interval that's used to retrieve message queue diagnostic information. The default value is `00:01:00` or one minute. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> |
| _RejectMessageOnShadowFailure_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _RejectMessageOnShadowFailure_ parameter specifies whether to accept or reject messages when shadow copies of the messages can't be created. Valid values are: <br/>  `$true`: Messages are rejected with the SMTP code 450 4.5.1. Use this value only if you have multiple Mailbox servers in a database availability group (DAG) or in an Active Directory site where shadow copies of the messages can be created.  <br/>  `$false`: Messages are accepted without making shadow copies. This is the default value.  <br/>  The number of attempts to make a shadow copy of the message and where to make the shadow copy are controlled by the _MaxRetriesForLocalSiteShadow_,  _MaxRetriesForRemoteSiteShadow_, and  _ShadowMessagePreferenceSetting_ parameter settings. <br/> |
| _Rfc2231EncodingEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _Rfc2231EncodingEnabled_ parameter specifies whether the RFC 2231 encoding of MIME parameters for outbound messages is enabled in your organization. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> |
| _SafetyNetHoldTime_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _SafetyNetHoldTime_ parameter specifies how long a copy of a successfully processed message is retained in Safety Net. Unacknowledged shadow copies of messages auto-expire from Safety Net based on adding the values of the _SafetyNetHoldTime_ parameter and the _MessageExpirationTimeout_ parameter on the **Set-TransportService** cmdlet. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> The default value is  `2.00:00:00` or 2 days. <br/> |
| _ShadowHeartbeatFrequency_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _ShadowHeartbeatFrequency_ parameter specifies the amount of time a server waits before establishing a connection to a primary server to query the discard status of shadow messages. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> Valid input for this parameter is 00:00:01 to 1.00:00:00. The default value is  `00:02:00` or 2 minutes. <br/> |
| _ShadowHeartbeatRetryCount_ <br/> |Optional  <br/> |System.Int32  <br/> |This parameter is available only in on-premises Exchange.  <br/> This parameter isn't used by Microsoft Exchange Server 2016. It's only used by Microsoft Exchange 2010 servers in a coexistence environment.  <br/> The  _ShadowHeartbeatRetryCount_ parameter specifies the number of time-outs a server waits before deciding that a primary server has failed and assumes ownership of shadow messages in the shadow queue for the primary server that's unreachable. Valid input for this parameter is an integer between 1 and 15. The default value is 12. <br/> This parameter is replaced by the  _ShadowResubmitTimeSpan_ parameter. <br/> |
| _ShadowHeartbeatTimeoutInterval_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> This parameter isn't used by Microsoft Exchange Server 2016. It's only used by Microsoft Exchange 2010 servers in a coexistence environment.  <br/> The  _ShadowHeartbeatTimeoutInterval_ parameter specifies the amount of time a server waits before establishing a connection to a primary server to query the discard status of shadow messages. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> Valid input for this parameter is 00:00:01 to 1.00:00:00. The default value is  `00:15:00` or 15 minutes. <br/> This parameter is replaced by the  _ShadowHeartbeatFrequency_ parameter. <br/> |
| _ShadowMessageAutoDiscardInterval_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _ShadowMessageAutoDiscardInterval_ parameter specifies how long a server retains discard events for shadow messages. A primary server queues discard events until queried by the shadow server. However, if the shadow server doesn't query the primary server for the duration specified in this parameter, the primary server deletes the queued discard events. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> Valid input for this parameter is  `00:00:05` to `90.00:00:00`. The default value is  `2.00:00:00` or 2 days. <br/> |
| _ShadowMessagePreferenceSetting_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ShadowMessagePreference  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _ShadowMessagePreferenceSetting_ parameter specifies the preferred location for making a shadow copy of a message. Valid values are: <br/>  `LocalOnly`: A shadow copy of the message should only be made on a server in the local Active Directory site.  <br/>  `RemoteOnly`: A shadow copy of the message should only be made on a server in a different Active Directory site.  <br/>  `PreferRemote`: Try to make a shadow copy of the message in a different Active Directory site. If the operation fails, try make a shadow copy of the message on a server in the local Active Directory site.  <br/>  The default value is `PreferRemote`.  <br/> |
| _ShadowRedundancyEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _ShadowRedundancyEnabled_ parameter specifies whether shadow redundancy is enabled in the organization. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
| _ShadowResubmitTimeSpan_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _ShadowResubmitTimeSpan_ parameter specifies amount of time a server waits before deciding that a primary server has failed and assumes ownership of shadow messages in the shadow queue for the primary server that's unreachable. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> Valid input for this parameter is 00:00:01 to 1.00:00:00. The default value is 03:00:00 or 3 hours.  <br/> This parameter replaces the  _ShadowHeartbeatRetryCount_ parameter. <br/> |
| _SmtpClientAuthenticationDisabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter is available only in the cloud-based service. <br/>  The _SmtpClientAuthenticationDisabled_parameter specifies whether to disable authenticated SMTP (SMTP AUTH) for the whole organization. Examples of clients and services that require authenticated SMTP to send email messages include:  <br/>  POP3 and IMAP4 clients. <br/>  Devices with scan to email capability. <br/>  Workflow applications that send email notifications. <br/>  Online services that send messages using internal email addresses in the organization. <br/>  Valid values for this parameter are: <br/>  `$true`: Authenticated SMTP is disabled.  <br/>  `$false`: Authenticated SMTP is enabled. This is the default value.  <br/> |
| _SupervisionTags_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _SupervisionTags_ parameter specifies the various tags that are used for transport supervision in the organization. <br/> When you install Exchange, two tags,  `Allow` and `Reject`, are created by default.  <br/> |
| _TLSReceiveDomainSecureList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _TLSReceiveDomainSecureList_ parameter specifies the domains from which you want to receive domain secured email by using mutual Transport Layer Security (TLS) authentication. To fully support mutual TLS authentication, you must also perform the following steps: <br/>  Enable Domain Security (Mutual Auth TLS) and the TLS authentication method on the Receive connectors that receive messages from the domains that you specified with the _TLSReceiveDomainSecureList_ parameter. <br/>  Specify the domains to which you want to send domain secured email by using the _TLSSendDomainSecureList_ parameter. <br/>  Enable Domain Security (Mutual Auth TLS) on the Send connectors that send messages to the domains that you specified in the _TLSSendDomainSecureList_ parameter. <br/>  To enter multiple values and overwrite any existing entries, use the following syntax: `<value1>,<value2>...`. If the values contain spaces or otherwise require quotation marks, you need to use the following syntax:  `"<value1>","<value2>"...`.  <br/>  To add or remove one or more values without affecting any existing entries, use the following syntax: `@{Add="<value1>","<value2>"...; Remove="<value1>","<value2>"...}`.  <br/>  The wildcard character (*) isn't supported in the domains listed in the _TLSReceiveDomainSecureList_ parameter or in the _TLSSendDomainSecureList_ parameter. The default value for both parameters is an empty list ({}). <br/> |
| _TLSSendDomainSecureList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _TLSSendDomainSecureList_ parameter specifies the domains from which you want to send domain secured email by using mutual TLS authentication. To fully support mutual TLS authentication, you must also perform the following steps: <br/>  Enable Domain Security (Mutual Auth TLS) on the Send connectors that send messages to the domains that you specified in the _TLSSendDomainSecureList_ parameter. <br/>  Specify the domains from which you want to receive domain secured email by using the _TLSReceiveDomainSecureList_ parameter. <br/>  Enable Domain Security (Mutual Auth TLS) and the TLS authentication method on the Receive connectors that receive messages from the domains that you specified in the _TLSReceiveDomainSecureList_ parameter. <br/>  To enter multiple values and overwrite any existing entries, use the following syntax: `<value1>,<value2>...`. If the values contain spaces or otherwise require quotation marks, you need to use the following syntax:  `"<value1>","<value2>"...`.  <br/>  To add or remove one or more values without affecting any existing entries, use the following syntax: `@{Add="<value1>","<value2>"...; Remove="<value1>","<value2>"...}`.  <br/>  Multiple domains may be separated by commas. The wildcard character (*) isn't supported in the domains listed in the _TLSSendDomainSecureList_ parameter or in the _TLSReceiveSecureList_ parameter. The default values for both parameters are an empty list ({}). <br/> |
| _TransportRuleAttachmentTextScanLimit_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter is available only in on-premises Exchange. <br/>  The _TransportRuleAttachmentTextScanLimit_ parameter specifies the maximum size of text to extract from attachments for scanning by attachment scanning predicates in transport rules and data loss prevention (DLP) policies. The default value is 150 kilobytes (KB). <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  If the amount of text in the attachment is larger than the value of this parameter, only the specified amount of text is scanned. For example, if a 5 megabyte attachment contains 300 kilobytes of text, and the value of _TransportRuleAttachmentTextScanLimit_ is 150 kilobytes, only the first 150 kilobytes of text are extracted and scanned. <br/> |
| _VerifySecureSubmitEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _VerifySecureSubmitEnabled_ parameter verifies that email clients submitting messages from mailboxes on Mailbox servers are using encrypted MAPI submission. The valid values for this parameter are `$true` or `$false`. The default value is  `$false` <br/> If the  _VerifySecureSubmitEnabled_ parameter is set to `$true`, and Outlook 2010 or later is used to submit the message, the message is marked as secure. If a previous version of Outlook is used to submit the message, the message is marked as anonymous.  <br/> If the  _VerifySecureSubmitEnabled_ parameter is set to `$false`, all MAPI message submissions are marked as secure. Messages submitted from mailboxes on the Mailbox server by using any MAPI client aren't checked for encrypted MAPI submission. If you use previous Outlook versions in your Exchange organization, you should set the  _VerifySecureSubmitEnabled_ parameter to `$false`.  <br/> |
| _VoicemailJournalingEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _VoicemailJournalingEnabled_ parameter specifies whether Unified Messaging voice mail messages are journaled by the Journaling agent. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
| _WhatIf_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The  _WhatIf_ switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch. <br/> |
| _Xexch50Enabled_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _Xexch50Enabled_ parameter specifies whether Xexch50 authentication should be enabled for backward compatibility with computers running Exchange 2003. Valid input for this parameter is `$true` or `$false`. The default value is  `$true`.  <br/> |
   
## Input Types
<a name="InputTypes"> </a>

To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data. 
  
## Return Types
<a name="ReturnTypes"> </a>

To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Output Type field is blank, the cmdlet doesn't return data. 
  

