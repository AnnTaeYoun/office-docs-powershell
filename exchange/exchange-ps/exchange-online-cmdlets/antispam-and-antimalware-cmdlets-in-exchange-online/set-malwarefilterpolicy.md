---
title: "Set-MalwareFilterPolicy"
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 1/25/2018
ms.audience: Admin
ms.topic: reference
ms.service: exchange-online
localization_priority: Normal
ms.assetid: 52d1ecdd-56fc-456a-8de7-4b31521ce2a5
description: "This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other."
---

# Set-MalwareFilterPolicy

This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other. 
  
Use the **Set-MalwareFilterPolicy** cmdlet to modify malware filter policies in your organization.
  
For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://technet.microsoft.com/library/bb123552.aspx). 
  
```
Set-MalwareFilterPolicy -Identity <MalwareFilterPolicyIdParameter> [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlertText | DeleteAttachmentAndUseCustomAlertText>] [-AdminDisplayName <String>] [-BypassInboundMessages <$true | $false>] [-BypassOutboundMessages <$true | $false>] [-Confirm [<SwitchParameter>]] [-CustomAlertText <String>] [-CustomExternalBody <String>] [-CustomExternalSubject <String>] [-CustomFromAddress <SmtpAddress>] [-CustomFromName <String>] [-CustomInternalBody <String>] [-CustomInternalSubject <String>] [-CustomNotifications <$true | $false>] [-DomainController <Fqdn>] [-EnableExternalSenderAdminNotifications <$true | $false>] [-EnableExternalSenderNotifications <$true | $false>] [-EnableFileFilter <$true | $false>] [-EnableInternalSenderAdminNotifications <$true | $false>] [-EnableInternalSenderNotifications <$true | $false>] [-ExternalSenderAdminAddress <SmtpAddress>] [-FileTypes <String[]>] [-InternalSenderAdminAddress <SmtpAddress>] [-MakeDefault <SwitchParameter>] [-WhatIf [<SwitchParameter>]] [-ZapEnabled <$true | $false>]

```

## Examples
<a name="Examples"> </a>

### Example 1

This example modifies the malware filter policy named Contoso Malware Filter Policy with the following settings:
  
- Delete messages that contain malware.
    
- Don't notify the message sender when malware is detected in the message.
    
- Notify the administrator admin@contoso.com when malware is detected in a message from an internal sender.
    
```
Set-MalwareFilterPolicy -Identity "Contoso Malware Filter Policy" -Action DeleteMessage -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

### Example 2

This example enables common attachment blocking in the malware filter policy named Default, and adds the file types "com" and "bat" without affecting the other file type entries.
  
```
$FileTypesAdd = Get-MalwareFilterPolicy -Identity Default | select -Expand FileTypes; $FileTypesAdd += "com","bat"; Set-MalwareFilterPolicy -Identity Default -EnableFileFilter $true -FileTypes $FileTypesAdd
```

### Example 3

This example modifies the malware filter policy named Default by removing an existing file type from common attachment blocking without affecting other file types that are already defined.
  
The first three commands return the existing list of file types. The first file type in the list has the index number 0, the second has the index number 1, and so on. You use the index number to specify the file type that you want to remove.
  
The last two commands remove the seventh file type that's displayed in the list.
  
```
$ft = Get-MalwareFilterPolicy -Identity Default; $a = [System.Collections.ArrayList]($ft.FileTypes); $a; $a.RemoveAt(6); Set-MalwareFilterPolicy -Identity Default -FileTypes $a
```

## Detailed Description
<a name="DetailedDescription"> </a>

You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://technet.microsoft.com/library/mt432940.aspx).
  
## Parameters
<a name="DetailedDescription"> </a>

|**Parameter**|**Required**|**Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _Identity_ <br/> |Required  <br/> |Microsoft.Exchange.Configuration.Tasks.MalwareFilterPolicyIdParameter  <br/> |The  _Identity_ parameter specifies the malware filter policy you want to modify. You can use any value that uniquely identifies the policy. For example, you can use the name, GUID or distinguished name (DN) of the malware filter policy. <br/> |
| _Action_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Directory.SystemConfiguration.MalwareFilteringAction  <br/> | The _Action_ parameter specifies the action to take when malware is detected in a message. Valid values are: <br/>  `DeleteMessage`: Deletes the message. This is the default value.  <br/>  `DeleteAttachmentAndUseDefaultAlert`: Delivers the message, but replaces the message contents with the default alert text.  <br/>  `DeleteAttachmentAndUseCustomAlert`: Delivers the message, but replaces the message contents with the custom alert text specified by the  _AlertText_ parameter . <br/> |
| _AdminDisplayName_ <br/> |Optional  <br/> |System.String  <br/> |The  _AdminDisplayName_parameter specifies a description for the policy. If the value contains spaces, enclose the value in quotation marks (").  <br/> |
| _BypassInboundMessages_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _BypassInboundMessages_ parameter skips or enforces malware scanning on incoming messages. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`. This means malware scanning occurs on incoming messages by default.  <br/> |
| _BypassOutboundMessages_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _BypassOutboundMessages_ parameter skips or enforces malware scanning on outgoing messages. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`. This means malware scanning occurs on outgoing messages by default.  <br/> |
| _Confirm_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Confirm_ switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding. <br/>  Destructive cmdlets (for example, **Remove-\*** cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.  <br/>  Most other cmdlets (for example, **New-\*** and **Set-\*** cmdlets) don't have a built-in pause. For these cmdlets, specifying the _Confirm_ switch without a value introduces a pause that forces you acknowledge the command before proceeding. <br/> |
| _CustomAlertText_ <br/> |Optional  <br/> |System.String  <br/> |The  _CustomAlertText_ parameter specifies the custom alert text to insert in the message when malware is detected and the value of the _Action_ parameter is set to `ReplaceWithCustomAlert`. This parameter is required when the  _CustomNotifications_ parameter is set to `$true`.  <br/> |
| _CustomExternalBody_ <br/> |Optional  <br/> |System.String  <br/> | The _CustomExternalBody_ parameter specifies the body of the custom notification message that's sent to an external sender when a message contains malware. This parameter is required when any of the following parameters are set to `$true`:  <br/>  _CustomNotifications_ <br/>  _EnableExternalSenderAdminNotifications_ <br/>  _EnableExternalSenderNotifications_ <br/> |
| _CustomExternalSubject_ <br/> |Optional  <br/> |System.String  <br/> | The _CustomExternalSubject_ parameter specifies the subject of the custom notification message that's sent to an external sender when a message contains malware. This parameter is required when any of the following parameters are set to `$true`:  <br/>  _CustomNotifications_ <br/>  _EnableExternalSenderAdminNotifications_ <br/>  _EnableExternalSenderNotifications_ <br/> |
| _CustomFromAddress_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpAddress  <br/> |The  _CustomFromAddress_ parameter specifies the From address of the custom notification message that's sent to an internal or external sender when a message contains malware. This parameter is required when the _CustomNotifications_ parameter is set to `$true`.  <br/> |
| _CustomFromName_ <br/> |Optional  <br/> |System.String  <br/> |The  _CustomFromName_ parameter specifies the From name of the custom notification message that's sent to internal or external senders when a message contains malware. This parameter is required when the _CustomNotifications_ parameter is set to `$true`.  <br/> |
| _CustomInternalBody_ <br/> |Optional  <br/> |System.String  <br/> | The _CustomInternalBody_ parameter specifies the body of the custom notification message that's sent to an internal sender when a message contains malware. This parameter is required when any of the following parameters are set to `$true`:  <br/>  _CustomNotifications_ <br/>  _EnableExternalSenderAdminNotifications_ <br/>  _EnableExternalSenderNotifications_ <br/> |
| _CustomInternalSubject_ <br/> |Optional  <br/> |System.String  <br/> | The _CustomInternalSubject_ parameter specifies the subject of the custom notification message that's sent to an internal sender when a message contains malware. This parameter is required when any of the following parameters are set to `$true`:  <br/>  _CustomNotifications_ <br/>  _EnableExternalSenderAdminNotifications_ <br/>  _EnableExternalSenderNotifications_ <br/> |
| _CustomNotifications_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _CustomNotifications_ parameter enables or disables the custom notification message to the sender when the message contains malware. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> If you enable custom notification messages by setting this parameter to  `$true`, you specify the details of the custom notification message using the  _CustomFromAddress_, _CustomFromName_,  _CustomExternalSubject_,  _CustomExternalBody_,  _CustomInternalSubject_, and  _CustomInternalBody_ parameters. <br/> |
| _DomainController_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> |This parameter is available only in on-premises Exchange.  <br/> The  _DomainController_ parameter specifies the domain controller that's used by this cmdlet to read data from or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN). For example, `dc01.contoso.com`.  <br/> |
| _EnableExternalSenderAdminNotifications_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _EnableExternalSenderAdminNotifications_ parameter enables or disables sending notification messages to an administrator when malware is detected in messages from external senders. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> Specify the administrator to receive the notification messages by using the  _ExternalSenderAdminAddress_ parameter. <br/> |
| _EnableExternalSenderNotifications_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _EnableExternalSenderNotifications_ parameter enables or disables sending notification messages to senders when malware is detected in messages from external senders. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> |
| _EnableFileFilter_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _EnableFileFilter_ parameter enables or disables common attachment blocking. Valid values are: <br/>  `$true`: Common attachment blocking is enabled.  <br/>  `$false`: Common attachment blocking is disabled.  <br/>  To configure the blocked file types, use the _FileTypes_ parameter. <br/> |
| _EnableInternalSenderAdminNotifications_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _EnableExternalSenderAdminNotifications_ parameter enables or disables sending notification messages to an administrator when malware is detected in messages from internal senders. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> Specify the administrator to receive the notification messages by using the  _InternalSenderAdminAddress_ parameter. <br/> |
| _EnableInternalSenderNotifications_ <br/> |Optional  <br/> |System.Boolean  <br/> |The  _EnableExternalSenderAdminNotifications_ parameter enables or disables sending notification messages to senders when malware is detected in messages from internal senders. Valid input for this parameter is `$true` or `$false`. The default value is  `$false`.  <br/> |
| _ExternalSenderAdminAddress_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpAddress  <br/> |The  _ExternalSenderAdminAddress_ parameter specifies the email address of the administrator who will receive notifications messages when messages from external senders contain malware. Notification messages are sent to the specified email address only if the _EnableExternalSenderAdminNotifications_ parameter is set to `$true`.  <br/> |
| _FileTypes_ <br/> |Optional  <br/> |System.String[]  <br/> | The _FileTypes_ parameter specifies the file types that are blocked by common attachment blocking. The default values are: <br/>  `ace` <br/>  `ani` <br/>  `app` <br/>  `docm` <br/>  `exe` <br/>  `jar` <br/>  `reg` <br/>  `scr` <br/>  `vbe` <br/>  `vbs` <br/>  You enable or disable common attachment blocking by using the _EnableFileFilter_ parameter. <br/>  Common attachment blocking uses best effort true-typing to detect the file type regardless of the file name extension. If true-typing fails or isn't supported for the specified file type, then extension matching is used. For example, ps1 files are Windows PowerShell scripts, but their true type is text. <br/>  To replace the existing list of file types with the values you specify, use the syntax `<FileType1>,<FileType2>...`. To preserve existing values, be sure to include the file types that you want to keep along with the new values that you want to add.  <br/>  To add or remove file types without affecting the other file type entries, see the Examples section. <br/> |
| _InternalSenderAdminAddress_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpAddress  <br/> |The  _InternalSenderAdminAddress_ parameter specifies the email address of the administrator who will receive notifications messages when messages from external senders contain malware. Notification messages are sent to the specified email address only if the _EnableInternalSenderAdminNotifications_ parameter is set to `$true`.  <br/> |
| _MakeDefault_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The  _MakeDefault_ switch makes this the default malware filter policy. You don't need to specify a value with this switch. <br/> |
| _WhatIf_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The  _WhatIf_ switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch. <br/> |
| _ZapEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _ZapEnabled_ parameter specifies whether to enable zero-hour auto purge (ZAP) for malware. ZAP detects malware in unread messages that have already been delivered to the user's Inbox. Valid values are: <br/>  `$true`: ZAP for malware is enabled. Unread messages in the user's Inbox that contain malware are moved to the Junk Email folder. This is the default value.  <br/>  `$false`: ZAP for malware is disabled.  <br/> |
   
## Input Types
<a name="InputTypes"> </a>

To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data. 
  
## Return Types
<a name="ReturnTypes"> </a>

To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Output Type field is blank, the cmdlet doesn't return data. 
  

