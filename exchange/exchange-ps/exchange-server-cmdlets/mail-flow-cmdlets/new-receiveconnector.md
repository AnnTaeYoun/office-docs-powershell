---
title: "New-ReceiveConnector"
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 2/6/2018
ms.audience: Developer
ms.topic: reference
ms.prod: exchange-server-itpro
localization_priority: Normal
ms.assetid: eb527447-ed68-4a55-943b-aad8c8a94d01

description: "This cmdlet is available only in on-premises Exchange."
---

# New-ReceiveConnector

This cmdlet is available only in on-premises Exchange.
  
Use the **New-ReceiveConnector** cmdlet to create Receive connectors on Mailbox servers and Edge Transport servers. Receive connectors listen for inbound SMTP connections on the Exchange server.
  
```
New-ReceiveConnector -Bindings <MultiValuedProperty> -RemoteIPRanges <MultiValuedProperty> [-Custom <SwitchParameter>] <COMMON PARAMETERS>

```

## Examples
<a name="Examples"> </a>

### Example 1

This example creates the custom Receive connector Test with the following properties:
  
- It listens for incoming SMTP connections on the IP address 10.10.1.1 and port 25.
    
- It accepts incoming SMTP connections only from the IP range 192.168.0.1-192.168.0.24
    
```
New-ReceiveConnector -Name Test -Usage Custom -Bindings 10.10.1.1:25 -RemoteIPRanges 192.168.0.1-192.168.0.24
```

## Detailed Description
<a name="DetailedDescription"> </a>

On Mailbox servers, you can create Receive connectors in the Front End Transport service, and the Transport (Hub) service. On Edge Transport servers, you can create Receive connectors in the Transport service.
  
For more information about Receive connector usage types, permission groups, and authentication methods, see [Receive Connectors](https://technet.microsoft.com/library/17751a60-39fe-433f-84d2-bfc14ff4ba51.aspx).
  
You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://technet.microsoft.com/library/mt432940.aspx).
  
## Parameters
<a name="DetailedDescription"> </a>

|**Parameter**|**Required**|**Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _Bindings_ <br/> |Required  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | The _Bindings_ parameter specifies the local IP address and TCP port number that's used by the Receive connector. This parameter uses the syntax `"<IPv4 Address>:<TCP Port>","<IPv6 Address>:<TCP Port>"`. You can specify an IPv4 address and port, and IPv6 address and port, or both. The IP address values  `0.0.0.0` or `[::]:` indicate that the Receive connector uses all available local IPv4 or all IPv6 addresses. <br/> > [!NOTE]>  You need to specify a valid local IP address from the network adapters of the Exchange server. If you specify an invalid local IP address, the Microsoft Exchange Transport service might fail to start when the service is restarted.           You need to use this parameter when you use these usage type parameters: <br/>  The _Internet_ switch (or the _Usage_ parameter with the value `Internet`).  <br/>  The _Partner_ switch (or the _Usage_ parameter with the value `Partner`).  <br/>  The _Custom_ switch (or the _Usage_ parameter with the value `Custom`).  <br/>  You can't use this parameter when you use the following usage type parameters: <br/>  The _Client_ switch (or the _Usage_ parameter with the value `Client`. The default value is  `0.0.0.0:587`.  <br/>  The _Internal_ switch (or _Usage_ parameter with the value `Internal`). The default value is  `0.0.0.0:25`.  <br/>  The values for this parameter must satisfy one of the following uniqueness requirements: <br/>  The combination of IP address and TCP port doesn't conflict with the IP address and TCP port that's used on another Receive connector on the server. <br/>  You use an existing combination of IP address and TCP port that's configured on another Receive connector on the server, but you restrict the remote IP addresses by using the _RemoteIPRanges_ parameter. When you create a Receive connector, you can only use the _RemoteIPRanges_ and _Bindings_ parameters together with the _Custom_ and _Partner_ switches (or the _Usage_ parameter with the value `Custom` or `Partner`).  <br/> |
| _Client_ <br/> |Required  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Client_ switch specifies the `Client` usage type for the Receive connector. You don't need to specify a value with this switch. <br/>  This usage type assigns the following default permission groups and authentication methods: <br/> **Permission groups**:  `ExchangeUsers` <br/> **Authentication methods**:  `TLS`,  `BasicAuth`,  `BasicAuthRequireTLS`, and  `Integrated`.  <br/>  When you use this switch, you also need to use the _RemoteIPRanges_ parameter, and you can't use the _Bindings_ parameter (the default value is `0.0.0.0:587`).  <br/>  You can't use this switch with any other usage type parameters ( _Internal_, _Internet_, _Partner_, _Custom_, or _Usage_).  <br/> |
| _Internal_ <br/> |Required  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Internal_ switch specifies the `Internal` usage type for the Receive connector. You don't need to specify a value with this switch. <br/>  This usage type assigns the following default permission groups and authentication methods: <br/> **Permission groups**:  `ExchangeLegacyServers` and `ExchangeServers`.  <br/> **Authentication methods**:  `TLS` and `ExchangeServers`.  <br/>  When you use this switch, you also need to use the _RemoteIPRanges_ parameter, and you can't use the _Bindings_ parameter (the default value is `0.0.0.0:25`).  <br/>  You can't use this switch with any other usage type parameters ( _Client_, _Internet_, _Partner_, _Custom_, or _Usage_).  <br/> |
| _Internet_ <br/> |Required  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Internet_ switch specifies the `Internet` usage type for the Receive connector. You don't need to specify a value with this switch. <br/>  This usage type assigns the following default permission groups and authentication methods: <br/> **Permission groups**:  `AnonymousUsers` <br/> **Authentication methods**:  `TLS` <br/>  When you use this switch, you also need to use the _Bindings_ parameter, and you can't use the _RemoteIPRanges_ parameter (the default value is `0.0.0.0-255.255.255.255`).  <br/>  You can't use this switch with any other usage type parameters ( _Client_, _Internal_, _Partner_, _Custom_, or _Usage_).  <br/> |
| _Name_ <br/> |Required  <br/> |System.String  <br/> |The _Name_ parameter specifies the unique name for the Receive connector. The maximum length is 64 characters. If the value contains spaces, enclose the value in quotation marks. <br/> |
| _Partner_ <br/> |Required  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Partner_ switch specifies the `Partner` usage type for the Receive connector. You don't need to specify a value with this switch. <br/>  This usage type assigns the following default permission groups and authentication methods: <br/> **Permission groups**:  `Partners` <br/> **Authentication methods**:  `TLS` <br/>  When you use this switch, you also need to use the _Bindings_ and _RemoteIPRanges_ parameters. <br/>  You can't use this switch with any other usage type parameters ( _Client_, _Internal_, _Internet_, _Custom_, or _Usage_).  <br/> |
| _RemoteIPRanges_ <br/> |Required  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | The _RemoteIPRanges_ parameter specifies the remote IP addresses that the Receive connector accepts messages from. Valid values are: <br/> **Single IP address**: For example,  `192.168.1.1` or `fe80::39bd:88f7:6969:d223%11`.  <br/> **IP address range**: For example,  `192.168.1.1-192.168.1.254`.  <br/> **Classless Inter-Domain Routing (CIDR) IP**: For example,  `192.168.1.1/24` or `2001:0DB8::CD3/60`.  <br/>  You can specify multiple value separated by commas ( `"<value1>","<value2>"...`).  <br/>  Multiple Receive connectors on the same server can have overlapping remote IP address ranges as long as one IP address range is completely overlapped by another. For example, you can configure the following remote IP address ranges on different Receive connectors on the same server: <br/>  `0.0.0.0` <br/>  `192.168.1.1/24` <br/>  `192.168.1.10` <br/>  When remote IP address ranges overlap, the Receive connector with the most specific match to the IP address of the connecting server is used. <br/>  You need to use this parameter with the following usage type parameters: <br/>  The _Client_ switch (or the _Usage_ parameter with the value `Client`).  <br/>  The _Internal_ switch (or the _Usage_ parameter with the value `Internal`).  <br/>  The _Partner_ switch (or the _Usage_ parameter with the value `Partner`).  <br/>  The _Custom_ switch (or the _Usage_ parameter with the value `Custom`).  <br/>  You can't use this parameter with the `Internet` usage type (the default value is `0.0.0.0-255.255.255.255`).  <br/> |
| _Usage_ <br/> |Required  <br/> |Microsoft.Exchange.Management.SystemConfigurationTasks.NewReceiveConnector+UsageType  <br/> | The _Usage_ parameter specifies the default permission groups and authentication methods that are assigned to the Receive connector. Valid values are: <br/>  `Client` <br/>  `Custom` <br/>  `Internal` <br/>  `Internet` <br/>  `Partner` <br/>  The following values for this parameter also require the _Bindings_ parameter: <br/>  `Internet` <br/>  `Partner` <br/>  `Custom` <br/>  The following values for this parameter also require the _RemoteIPRanges_ parameter: <br/>  `Client` <br/>  `Internal` <br/>  `Partner` <br/>  `Custom` <br/>  For a description of the default permission groups and authentication methods that are assigned for each value, see the corresponding usage type switch descriptions. <br/>  You can't use this parameter with any other usage type switches ( _Client_, _Internal_, _Internet_, _Custom_, or _Partner_).  <br/> |
| _AdvertiseClientSettings_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _AdvertiseClientSettings_ parameter specifies whether the SMTP server name, port number, and authentication settings for the Receive connector are displayed to users in the options of Outlook on the web. Valid values are: <br/>  `$true`: The SMTP values are displayed in Outlook on the web. Typically, you would only use this setting for a Receive connector with the usage type  `Client` (authenticated SMTP connections on TCP port 587 for POP3 and IMAP4 clients). <br/>  `$false`: The SMTP values are displayed in Outlook on the web. This is the default value.  <br/> |
| _AuthMechanism_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Directory.SystemConfiguration.AuthMechanisms  <br/> | The _AuthMechanism_ parameter specifies the advertised and accepted authentication mechanisms for the Receive connector. Valid values are: <br/>  `None` <br/>  `Tls` <br/>  `Integrated` <br/>  `BasicAuth` <br/>  `BasicAuthRequireTLS` <br/>  `ExchangeServer` <br/>  `ExternalAuthoritative` <br/>  You can specify multiple values separated by commas, but some values have dependencies and exclusions: <br/>  You can only use the value `None` by itself. <br/>  The value `BasicAuthRequireTLS` also requires the values `BasicAuth` and `Tls`.  <br/>  The only other value that you can use with `ExternalAuthoritative` is `Tls`.  <br/>  The value `Tls` is required when the value of the _RequireTLS_ parameter is `$true`.  <br/>  The value `ExternalAuthoritative` requires you to set the value of the _PermissionGroups_ parameter to `ExchangeServers`.  <br/> |
| _AuthTarpitInterval_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |The _AuthTarpitInterval_ parameter specifies the period of time to delay responses to failed authentication attempts from remote servers that may be abusing the connection. The default value is 5 seconds. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> When you set the value to  `00:00:00`, you disable the authentication tarpit interval. Setting the value to more than a few seconds can cause timeouts and mail flow issues.  <br/> You can configure the delay for other SMTP failure responses by using the _TarpitInterval_ parameter. <br/> |
| _Banner_ <br/> |Optional  <br/> |System.String  <br/> |The _Banner_ parameter specifies a custom SMTP 220 banner that's displayed to remote messaging servers that connect to the Receive connector. When you specify a value, enclose the value in quotation marks, and start the value with `220` (the default "Service ready" SMTP response code). <br/>  The default value of this parameter is blank ( `$null`), which uses the following SMTP banner:  <br/>  `220 <Servername> Microsoft ESMTP MAIL service ready at <RegionalDay-Date-24HourTimeFormat><RegionalTimeZoneOffset>` <br/> |
| _BinaryMimeEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _BinaryMimeEnabled_ parameter specifies whether the `BINARYMIME` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `BINARYMIME` is enabled and is advertised in the EHLO response. This setting requires that the _ChunkingEnabled_ parameter is also set to the value `$true`. This is the default value.  <br/>  `$false`:  `BINARYMIME` is disabled and isn't advertised in the EHLO response. <br/>  The binary MIME extension is defined in RFC 3030. <br/> |
| _ChunkingEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _ChunkingEnabled_ parameter specifies whether the `CHUNKING` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `CHUNKING` is enabled and is advertised in the EHLO response. This is the default value. <br/>  `$false`:  `CHUNKING` is disabled and isn't advertised in the EHLO response. <br/>  Chunking is defined in RFC 3030. <br/> |
| _Comment_ <br/> |Optional  <br/> |System.String  <br/> |The _Comment_ parameter specifies an optional comment. If you specify a value that contains spaces, enclose the value in quotation marks ("), for example: `"This is an admin note"`.  <br/> |
| _Confirm_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Confirm_ switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding. <br/>  Destructive cmdlets (for example, **Remove-\*** cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.  <br/>  Most other cmdlets (for example, **New-\*** and **Set-\*** cmdlets) don't have a built-in pause. For these cmdlets, specifying the _Confirm_ switch without a value introduces a pause that forces you acknowledge the command before proceeding. <br/> |
| _ConnectionInactivityTimeout_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |The _ConnectionInactivityTimeout_ parameter specifies the maximum amount of idle time before a connection to the Receive connector is closed. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> A valid value for this parameter is  `00:00:01` (one second) to `1.00:00:00` (one day). <br/>  The default value for Receive connectors on Mailbox servers is `00:05:00` (5 minutes). The default value for Receive connectors on Edge Transport servers is `00:01:00` (1 minute). <br/> The value of this parameter must be less than the value of the _ConnectionTimeout_ parameter. <br/> |
| _ConnectionTimeout_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |The _ConnectionTimeout_ parameter specifies the maximum time that the connection to the Receive connector can remain open, even if the connection is actively transmitting data. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> A valid value for this parameter is  `00:00:01` (one second) to `1.00:00:00` (one day). <br/>  The default value for Receive connectors on Mailbox servers is `00:10:00` (10 minutes). The default value for Receive connectors on Edge Transport servers is `00:05:00` (5 minutes). <br/> The value of this parameter must be greater than the value of the _ConnectionInactivityTimeout_ parameter. <br/> |
| _Custom_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Custom_ switch specifies the `Custom` usage type for the Receive connector. You don't need to specify a value with this switch. <br/>  This usage type assigns the following default permission groups and authentication methods: <br/> **Permission groups**:  `None` <br/> **Authentication methods**:  `TLS` <br/>  When you use this switch, you also need to use the _Bindings_ and _RemoteIPRanges_ parameters. <br/>  If you don't also use the _PermissionGroups_ parameter to assign at least one permission group, you'll need to use the _PermissionGroups_ parameter on the **Set-ReceiveConnector** cmdlet after you create the Receive connector (otherwise, the Receive connector can't accept inbound SMTP connections). <br/>  You can't use this switch with any other usage type parameters ( _Client_, _Internal_, _Internet_, _Partner_, or _Usage_).  <br/> |
| _DefaultDomain_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.AcceptedDomainIdParameter  <br/> | The _DefaultDomain_ parameter specifies the default accepted domain to use for the Exchange organization. You can use any value that uniquely identifies the accepted domain. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  GUID <br/>  Although you can configure any accepted domain as the default domain, you typically specify an authoritative domain. The default domain is used by: <br/>  The external postmaster address: postmaster@ _\<default domain\>_.  <br/>  Encapsulated non-SMTP email addresses (Internet Mail Connector Encapsulated Address or IMCEA encapsulation). <br/>  The primary address for all recipients in the default email address policy. If you configure another accepted domain as the default domain, the default email address policy isn't automatically updated. <br/> |
| _DeliveryStatusNotificationEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _DeliveryStatusNotificationEnabled_ parameter specifies whether the `DSN` (delivery status notification) Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `DSN` is enabled and is advertised in the EHLO response. This is the default value. <br/>  `$false`:  `DSN` is disabled and isn't advertised in the EHLO response. <br/>  Delivery status notifications are defined in RFC 3461. <br/> |
| _DomainController_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> |The _DomainController_ parameter specifies the domain controller that's used by this cmdlet to read data from or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN). For example, `dc01.contoso.com`.  <br/> The _DomainController_ parameter isn't supported on Edge Transport servers. An Edge Transport server uses the local instance of Active Directory Lightweight Directory Services (AD LDS) to read and write data. <br/> |
| _DomainSecureEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _DomainSecureEnabled_ parameter specifies whether to enable or disable mutual Transport Layer Security (TLS) authentication (also known as Domain Secure) for the domains that are serviced by the Receive connector. Valid values are: <br/>  `$true`: Mutual TLS authentication is enabled.  <br/>  `$false`: Mutual TLS authentication is disabled.  <br/>  Note that setting this parameter to the value `$true` is only part of the requirements for enabling mutual TLS authentication: <br/>  The _AuthMechanism_ parameter must contain the value `Tls`, and can't contain the value  `ExternalAuthoritative`.  <br/>  The domain that's used for mutual TLS authentication must be configured in the following locations: <br/>  The _TLSReceiveDomainSecureList_ parameter on the **Set-TransportConfig** cmdlet. <br/>  The _AddressSpaces_ parameter on the **Set-SendConnector** cmdlet for the corresponding Send connector. <br/>  The _TLSSendDomainSecureList_ parameter on the **Set-TransportConfig** cmdlet. <br/> |
| _EightBitMimeEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _EightBitMimeEnabled_ parameter specifies whether the `8BITMIME` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `8BITMIME` is enabled and is advertised in the EHLO response. This is the default value. <br/>  `$false`:  `8BITMIME` is disabled and isn't advertised in the EHLO response. <br/>  8-bit data transmission is defined in RFC 6152. <br/> |
| _EnableAuthGSSAPI_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _EnableAuthGSSAPI_ parameter enables or disables Kerberos when Integrated Windows authentication is available on the Receive connector (the _AuthMechanism_ parameter contains the value `Integrated`). Valid values are:  <br/>  `$true`: Kerberos is enabled. The Extended SMTP keyword  `AUTH GSSAPI NTLM` is advertised in the EHLO response. Clients can use Kerberos or NTLM for Integrated Windows authentication. <br/>  `$false`: Kerberos is disabled. The Extended SMTP keyword  `AUTH NTLM` is advertised in the EHLO response. Clients can only use NTLM for Integrated Windows authentication. <br/>  The Generic Security Services application programming interface (GSSAPI) is an IETF standard for accessing security services. <br/> |
| _Enabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _Enabled_ parameter specifies whether to enable or disable the Receive connector. Valid values are: <br/>  `$true`: The Receive connector is enabled. This is the default value.  <br/>  `$false`: The Receive connector is disabled.  <br/> |
| _EnhancedStatusCodesEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _EnhancedStatusCodesEnabled_ parameter specifies whether the `ENHANCEDSTATUSCODES` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `ENHANCEDSTATUSCODES` is enabled and is advertised in the EHLO response. This is the default value. <br/>  `$false`:  `ENHANCEDSTATUSCODES` is disabled and isn't advertised in the EHLO response. <br/>  Enhanced status codes are defined in RFC 2034. <br/> |
| _ExtendedProtectionPolicy_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Directory.SystemConfiguration.ExtendedProtectionPolicySetting  <br/> | The _ExtendedProtectionPolicy_ parameter specifies how Extended Protection for Authentication is implemented on the Receive connector. Valid values are: <br/>  `None`: Extended Protection for Authentication isn't used. This is the default value.  <br/>  `Allow`: Extended Protection for Authentication is used only if the connecting host supports it. Otherwise, connections are established without Extended Protection for Authentication.  <br/>  `Require`: Extended Protection for Authentication is required for all incoming connections to this Receive connector. If the connecting host doesn't support Extended Protection for Authentication, the connection is rejected.  <br/>  Extended Protection for Authentication enhances the protection and handling of credentials when authenticating network connections using Integrated Windows authentication. Integrated Windows authentication is also known as NTLM. We strongly recommend that you use Extended Protection for Authentication if you are using Integrated Windows authentication. <br/> |
| _Fqdn_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> | The _Fqdn_ parameter specifies the destination FQDN that's shown to connected messaging servers. This value is used in the following locations: <br/>  In the default SMTP banner of the Receive connector. <br/>  In the EHLO/HELO response of the Receive connector. <br/>  In the most recent `Received` header field in the incoming message when. <br/>  During TLS authentication. <br/>  The default value is the FQDN of theExchange server that contains the Receive connector (for example `edge01.contoso.com`). You can specify a different FQDN (for example,  `mail.contoso.com`).  <br/> |
| _LongAddressesEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _LongAddressesEnabled_ parameter specifies whether the Receive connector accepts long X.400 email addresses. The X.400 email addresses are encapsulated in SMTP email addresses by using the Internet Mail Connector Encapsulated Address (IMCEA) encapsulation method. Valid values are <br/>  `$true`: X.400 email addresses can be up to 1,860 characters long after IMCEA encapsulation.  <br/>  `$false`: The maximum length of a complete SMTP email address is 571 characters. This is the default value.  <br/>  When you set this parameter to the value `$true`, the following changes are made to the Receive connector:  <br/>  The `XLONGADDR` Extended SMTP extension is enabled and is advertised in the EHLO response. <br/>  The accepted line length of an SMTP session is increased to 8,000 characters. <br/>  Valid long addresses are accepted by the `MAIL FROM` and `RCPT TO` SMTP commands. <br/>  You can only configure this parameter on Receive connectors in the Transport service on Mailbox servers. <br/> |
| _MaxAcknowledgementDelay_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |This parameter isn't used by Microsoft Exchange Server 2016. It's only used by Microsoft Exchange 2010 servers in a coexistence environment.  <br/> The _MaxAcknowledgementDelay_ parameter specifies the maximum period the transport server delays acknowledgement until it verifies that the message has been successfully delivered to all recipients. When receiving messages from a host that doesn't support shadow redundancy, an Exchange Server 2010 transport server will delay issuing an acknowledgement until it verifies that the message has been successfully delivered to all recipients. However, if it takes too long to verify successful delivery, the transport server will time out and issue an acknowledgement anyway. <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> The default value is 30 seconds.  <br/> |
| _MaxHeaderSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | The _MaxHeaderSize_ parameter specifies the maximum size of the SMTP message header before the Receive connector closes the connection. The default value is 256 kilobytes (262144 bytes). <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  A valid value is from 1 to 2147483647 bytes. <br/> |
| _MaxHopCount_ <br/> |Optional  <br/> |System.Int32  <br/> |The _MaxHopCount_ parameter specifies the maximum number of hops that a message can take before the message is rejected by the Receive connector. The maximum number of hops is determined by the number of `Received` header fields that exist in a submitted message. <br/> A valid value is from 1 to 500. The default value is 30.  <br/> |
| _MaxInboundConnection_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> |The _MaxInboundConnection_ parameter specifies the maximum number of inbound connections that this Receive connector serves at the same time. <br/> A valid value is from 1 to 2147483647, or the value  `unlimited`. The default value is 5000.  <br/>  To disable the inbound connection limit on a Receive connector, enter a value of `unlimited`.  <br/> |
| _MaxInboundConnectionPercentagePerSource_ <br/> |Optional  <br/> |System.Int32  <br/> |The _MaxInboundConnectionPercentagePerSource_ parameter specifies the maximum number of connections that a Receive connector serves at the same time from a single IP address, expressed as the percentage of available remaining connections on a Receive connector. <br/> A valid value is from 1 to 100 without the percent sign (%). The default value is 2 percent.  <br/> |
| _MaxInboundConnectionPerSource_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> |The _MaxInboundConnectionPerSource_ parameter specifies the maximum number of connections that this Receive connector serves at the same time from a single IP address. <br/> A valid value is from 1 to 10000, or the value  `unlimited`. The default value is 20.  <br/>  To disable the inbound connection per source limit on a Receive connector, enter a value of `unlimited`.  <br/> |
| _MaxLocalHopCount_ <br/> |Optional  <br/> |System.Int32  <br/> |The _MaxLocalHopCount_ parameter specifies the maximum number of local hops that a message can take before the message is rejected by the Receive connector. The maximum number of local hops is determined by the number of `Received` headers with local server addresses in a submitted message. <br/> A valid value is from 0 to 50. The default value is 8.  <br/> When you specify the value 0, the message is never rejected based on the number of local hops.  <br/> |
| _MaxLogonFailures_ <br/> |Optional  <br/> |System.Int32  <br/> |The _MaxLogonFailures_ parameter specifies the number of logon failures that the Receive connector retries before it closes the connection. <br/> A valid value is from 0 to 10. The default value is 3.  <br/>  When you specify the value 0, the connection is never closed because of logon failures. <br/> |
| _MaxMessageSize_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | The _MaxMessageSize_ parameter specifies the maximum size of a message that's allowed through the Receive connector. The default value is 36 MB, which results in a realistic maximum message size of 25 MB. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/>  A valid value for this parameter is from 65536 to 2147483647 bytes. <br/>  For any message size limit, you need to set a value that's larger than the actual size you want enforced. This accounts for the Base64 encoding of attachments and other binary data. Base64 encoding increases the size of the message by approximately 33%, so the value you specify should be approximately 33% larger than the actual message size you want enforced. For example, if you specify a maximum message size value of 64 MB, you can expect a realistic maximum message size of approximately 48 MB. <br/> |
| _MaxProtocolErrors_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> |The _MaxProtocolErrors_ parameter specifies the maximum number of SMTP protocol errors that the Receive connector accepts before closing the connection. <br/> A valid value is from 0 to 2147483647, or the value  `unlimited`. The default value is 5.  <br/>  When you specify the value `unlimited`, a connection is never closed because of protocol errors.  <br/> |
| _MaxRecipientsPerMessage_ <br/> |Optional  <br/> |System.Int32  <br/> |The _MaxRecipientsPerMessage_ parameter specifies the maximum number of recipients per message that the Receive connector accepts before closing the connection. <br/> A valid value is from 1 to 512000. The default value is 200.  <br/> |
| _MessageRateLimit_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Unlimited  <br/> |The _MessageRateLimit_ parameter specifies the maximum number of messages that can be sent by a single client IP address per minute. <br/> A valid value is from 1 to 2147483647, or the value  `unlimited`.  <br/>  To remove the message rate limit on a Receive connector, enter a value of `unlimited`.  <br/> The default value for Receive connectors on Mailbox servers is  `unlimited`. The default value for Receive connectors on an Edge Transport servers is 600.  <br/> |
| _MessageRateSource_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Directory.SystemConfiguration.MessageRateSourceFlags  <br/> | The _MessageRateSource_ parameter specifies how the message submission rate is calculated. Valid values are: <br/>  `None`: The message submission rate isn't calculated.  <br/>  `User`: The message submission rate is calculated for sending users (specified with the  `MAIL FROM` SMTP command). <br/>  `IPAddress`: The message submission rate is calculated for sending hosts.  <br/>  `All`: The message submission rate is calculated for both sending users and sending hosts.  <br/> |
| _OrarEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _OrarEnabled_ parameter enables or disables Originator Requested Alternate Recipient (ORAR) on the Receive connector. Valid values are: <br/>  `$true`: ORAR is enabled and is advertised in the  `XORAR` keyword in the EHLO response. The actual ORAR information is transmitted in the `RCPT TO` SMTP command. <br/>  `$false`: ORAR is disabled and is isn't advertised in the EHLO response. This is the default value.  <br/>  If the email address specified in the ORAR information is a long X.400 email address, you need to set the _LongAddressesEnabled_ parameter to the value `$true`.  <br/> |
| _PermissionGroups_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.PermissionGroups  <br/> | The _PermissionGroups_ parameter specifies the well-known security principals who are authorized to use the Receive connector, and the permissions that are assigned to them. Valid values are: <br/>  `None` <br/>  `AnonymousUsers` <br/>  `ExchangeUsers` <br/>  `ExchangeServers` <br/>  `ExchangeLegacyServers` <br/>  `Partners` <br/>  `Custom` <br/>  The default permission groups that are assigned to a Receive connector depend on the connector usage type parameter that was used when the connector was created ( _Client_, _Internal_, _Internet_, _Partner_, or _Usage_).  <br/>  When you use the value `Custom`, you need to configure individual permissions by using the **Add-ADPermission** cmdlet. <br/>  For more information about the default permissions and security principals for permission groups, see[Receive connector permission groups](https://technet.microsoft.com/library/17751a60-39fe-433f-84d2-bfc14ff4ba51.aspx#PermissionGroups).  <br/> |
| _PipeliningEnabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _PipeliningEnabled_ parameter specifies whether the `PIPELINING` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `PIPELINING` is enabled and is advertised in the EHLO response. This is the default value. <br/>  `$false`:  `PIPELINING` is disabled and isn't advertised in the EHLO response. <br/>  Pipelining is defined in RFC 2920. <br/> |
| _ProtocolLoggingLevel_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ProtocolLoggingLevel  <br/> | The _ProtocolLoggingLevel_ parameter specifies whether to enable or disable protocol logging for the Receive connector. Valid values are: <br/>  `None`: Protocol logging is disabled on the Receive connector. This is the default value.  <br/>  `Verbose`: Protocol logging is enabled on the Receive connector.  <br/>  For more information about protocol logging, see[Protocol Logging](https://technet.microsoft.com/library/40da446b-bcc3-4a97-ace7-a54f6ddebd79.aspx).  <br/> |
| _RejectReservedSecondLevelRecipientDomains_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _RejectReservedSecondLevelRecipientDomains_parameter specifies whether to reject connections that contain recipients in reserved second-level domains as specified in RFC 2606 (example.com, example.net, or example.org). Valid value are:  <br/>  `$true`: **RCPT TO** commands that contain reserved second-level domains are rejected. <br/>  `$false`: **RCPT TO** commands that contain reserved second-level domains aren't rejected. This is the default value. <br/> |
| _RejectReservedTopLevelRecipientDomains_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _RejectReservedTopLevelRecipientDomains_parameter specifies whether to reject connections that contain recipients in reserved top-level domains (TLDs) as specified in RFC 2606 (.test, .example, .invalid, or .localhost). Valid value are:  <br/>  `$true`: **RCPT TO** commands that contain reserved TLDs are rejected. <br/>  `$false`: **RCPT TO** commands that contain reserved TLDs aren't rejected. This is the default value. <br/> |
| _RejectSingleLabelRecipientDomains_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _RejectSingleLabelRecipientDomains_parameter specifies whether to reject connections that contain recipients in single-label domains (for example, chris@contoso instead of chris@contoso.com). Valid values are:  <br/>  `$true`: **RCPT TO** commands that contain single-label domains are rejected. <br/>  `$false`: **RCPT TO** commands that contain single-label domains aren't rejected. This is the default value. <br/> |
| _RequireEHLODomain_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _RequireEHLODomain_ parameter specifies whether the client must provide a domain name in the EHLO handshake after the SMTP connection is established. Valid values are: <br/>  `$true`: The client must provide a domain name in the EHLO handshake. If it doesn't, the SMTP connection is closed.  <br/>  `$false`: The client isn't required to provide a domain name in the EHLO handshake. This is the default value.  <br/> |
| _RequireTLS_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _RequireTLS_ parameter specifies whether to require TLS transmission for inbound messages on the Receive connector. Valid values are: <br/>  `$true`: Inbound messages on the Receive connector require TLS transmission.  <br/>  `$false`: Inbound messages on the Receive connector don't require TLS transmission. This is the default value.  <br/> |
| _Server_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.ServerIdParameter  <br/> | The _Server_ parameter specifies the Exchange server where you want to run this command. You can use any value that uniquely identifies the server. For example: <br/>  Name <br/>  FQDN <br/>  Distinguished name (DN) <br/>  Exchange Legacy DN <br/>  If you don't use this parameter, the command is run on the local server. <br/> |
| _ServiceDiscoveryFqdn_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> |The _ServiceDiscoveryFqdn_ parameter specifies the service discovery fully-qualified domain name (FQDN) for the Receive connector. <br/> |
| _SizeEnabled_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SizeMode  <br/> | The _SizeEnabled_ parameter specifies how the `SIZE` Extended SMTP extension is used on the Receive connector. Valid values are: <br/>  `Enabled`:  `SIZE` is enabled and is advertised in the EHLO response along with the value of the _MaxMessageSize_ parameter. If the size of the inbound message exceeds the specified value, the Receive connector closes the connection with an error code. This is the default value. <br/>  `Disabled`:  `SIZE` is disabled and isn't advertised in the EHLO response. <br/>  `EnabledwithoutValue`:  `SIZE` is enabled and is advertised in the EHLO response, but the value of the _MaxMessageSize_ parameter isn't disclosed in the EHLO response. This setting allows messages to bypass message size checks for authenticated connections between Mailbox servers. <br/>  `SIZE` is defined in RFC 1870. <br/> |
| _SuppressXAnonymousTls_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _SuppressXAnonymousTls_ parameter specifies whether the `X-ANONYMOUSTLS` Extended SMTP extension is enabled or disabled on the Receive connector. Valid values are: <br/>  `$true`:  `X-ANONYMOUSTLS` is disabled and isn't advertised in the EHLO response. This setting also requires that you set the _UseDownGradedExchangeServerAuth_ parameter to the value `$true` on the **Set-TransportService** cmdlet on the server. <br/>  `$false`:  `X-ANONYMOUSTLS` is enabled and is advertised in the EHLO response. This is the default value. <br/>  The `X-ANONYMOUSTLS` extension is important when the _AuthMechanism_ parameter contains the value `ExchangeServer`.  <br/> |
| _TarpitInterval_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EnhancedTimeSpan  <br/> |The _TarpitInterval_ parameter specifies the amount of time to delay an SMTP response to a remote server that may be abusing the connection. The default value is `00:00:05` (5 seconds.). <br/> To specify a value, enter it as a time span:  `dd.hh:mm:ss` where `dd` = days, `hh` = hours, `mm` = minutes, and `ss` = seconds. <br/> When you set the value to  `00:00:00`, you disable the tarpit interval. Setting this value to more than a few seconds can cause timeouts and mail flow issues.  <br/> You can configure the delay for authentication failure responses by using the _AuthTarpitInterval_ parameter. <br/> |
| _TlsCertificateName_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SmtpX509Identifier  <br/> |The _TlsCertificateName_ parameter specifies the X.509 certificate to use for TLS encryption. A valid value for this parameter is `"<I>X.500Issuer<S>X.500Subject"`. The _X.500Issuer_ value is found in the certificate's `Issuer` field, and the _X.500Subject_ value is found in the certificate's `Subject` field. You can find these values by running the **Get-ExchangeCertificate** cmdlet. Or, after you run **Get-ExchangeCertificate** to find the thumbprint value of the certificate, run the command `$TLSCert = Get-ExchangeCertificate -Thumbprint <Thumbprint>`, run the command  `$TLSCertName = "<I>$($TLSCert.Issuer)<S>$($TLSCert.Subject)"`, and then use the value  `$TLSCertName` for this parameter. <br/> |
| _TlsDomainCapabilities_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | The _TlsDomainCapabilities_ parameter specifies the capabilities that the Receive connector makes available to specific hosts outside of the organization. Remote hosts are authenticated with TLS with certificate validation before these capabilities are offered. <br/>  This parameter uses the following syntax: <br/>  `"<domain1>:<capability1>,<capability 2>>"...,"<domain2>:<capability1>,<capability2>..."...` <br/>  The available _\<capability\>_ values are: <br/>  `AcceptOorgProtocol` <br/>  `AcceptOorgHeader` <br/>  The available _\<domainy\>_ values are an SMTP domain (for example, `contoso.com`), or the value  `NO-TLS` for non-TLS encrypted inbound connections. <br/>  For example, `"contoso.com:AcceptOorgProtocol","fabrikam.com:AcceptOorgProtocol,AcceptOorgHeader"` <br/> |
| _TransportRole_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Directory.SystemConfiguration.ServerRole  <br/> | The _TransportRole_ parameter specifies the transport service on the Mailbox server where the Receive connector is created.. Valid values are: <br/>  `FrontendTransport`: The Front End Transport service where client or external SMTP connections occur.  <br/>  `HubTransport`: The Transport service where Exchange server and proxied client SMTP connections occur.  <br/> |
| _WhatIf_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The _WhatIf_ switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch. <br/> |
   
## Input Types
<a name="InputTypes"> </a>

To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data. 
  
## Return Types
<a name="ReturnTypes"> </a>

To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Output Type field is blank, the cmdlet doesn't return data. 
  

