---
title: "New-TransportRule"
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 1/12/2018
ms.audience: Developer
ms.topic: reference
ms.prod: exchange-server-itpro
localization_priority: Normal
ms.assetid: eb3546bf-ca37-474e-9c22-962fe95af276

description: "This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other."
---

# New-TransportRule

This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other. 
  
Use the **New-TransportRule** cmdlet to create transport rules (mail flow rules) in your organization.
  
For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://technet.microsoft.com/library/bb123552.aspx). 
  
```
New-TransportRule -Name <String> [-ActivationDate <DateTime>] [-ADComparisonAttribute <DisplayName | FirstName | Initials | LastName | Office | PhoneNumber | OtherPhoneNumber | Email | Street | POBox | City | State | ZipCode | Country | UserLogonName | HomePhoneNumber | OtherHomePhoneNumber | PagerNumber | MobileNumber | FaxNumber | OtherFaxNumber | Notes | Title | Department | Company | Manager | CustomAttribute1 | CustomAttribute2 | CustomAttribute3 | CustomAttribute4 | CustomAttribute5 | CustomAttribute6 | CustomAttribute7 | CustomAttribute8 | CustomAttribute9 | CustomAttribute10 | CustomAttribute11 | CustomAttribute12 | CustomAttribute13 | CustomAttribute14 | CustomAttribute15>] [-ADComparisonOperator <Equal | NotEqual>] [-AddManagerAsRecipientType <To | Cc | Bcc | Redirect>] [-AddToRecipients <RecipientIdParameter[]>] [-AnyOfCcHeader <RecipientIdParameter[]>] [-AnyOfCcHeaderMemberOf <RecipientIdParameter[]>] [-AnyOfRecipientAddressContainsWords <Word[]>] [-AnyOfRecipientAddressMatchesPatterns <Pattern[]>] [-AnyOfToCcHeader <RecipientIdParameter[]>] [-AnyOfToCcHeaderMemberOf <RecipientIdParameter[]>] [-AnyOfToHeader <RecipientIdParameter[]>] [-AnyOfToHeaderMemberOf <RecipientIdParameter[]>] [-ApplyClassification <String>] [-ApplyHtmlDisclaimerFallbackAction <Wrap | Ignore | Reject>] [-ApplyHtmlDisclaimerLocation <Append | Prepend>] [-ApplyHtmlDisclaimerText <DisclaimerText>] [-ApplyOME <$true | $false>] [-ApplyRightsProtectionTemplate <RmsTemplateIdParameter>] [-AttachmentContainsWords <Word[]>] [-AttachmentExtensionMatchesWords <Word[]>] [-AttachmentHasExecutableContent <$true | $false>] [-AttachmentIsPasswordProtected <$true | $false>] [-AttachmentIsUnsupported <$true | $false>] [-AttachmentMatchesPatterns <Pattern[]>] [-AttachmentNameMatchesPatterns <Pattern[]>] [-AttachmentProcessingLimitExceeded <$true | $false>] [-AttachmentPropertyContainsWords <Word[]>] [-AttachmentSizeOver <ByteQuantifiedSize>] [-BetweenMemberOf1 <RecipientIdParameter[]>] [-BetweenMemberOf2 <RecipientIdParameter[]>] [-BlindCopyTo <RecipientIdParameter[]>] [-Comments <String>] [-Confirm [<SwitchParameter>]] [-ContentCharacterSetContainsWords <Word[]>] [-CopyTo <RecipientIdParameter[]>] [-DeleteMessage <$true | $false>] [-Disconnect <$true | $false>] [-DlpPolicy <String>] [-DomainController <Fqdn>] [-Enabled <$true | $false>] [-ExceptIfADComparisonAttribute <DisplayName | FirstName | Initials | LastName | Office | PhoneNumber | OtherPhoneNumber | Email | Street | POBox | City | State | ZipCode | Country | UserLogonName | HomePhoneNumber | OtherHomePhoneNumber | PagerNumber | MobileNumber | FaxNumber | OtherFaxNumber | Notes | Title | Department | Company | Manager | CustomAttribute1 | CustomAttribute2 | CustomAttribute3 | CustomAttribute4 | CustomAttribute5 | CustomAttribute6 | CustomAttribute7 | CustomAttribute8 | CustomAttribute9 | CustomAttribute10 | CustomAttribute11 | CustomAttribute12 | CustomAttribute13 | CustomAttribute14 | CustomAttribute15>] [-ExceptIfADComparisonOperator <Equal | NotEqual>] [-ExceptIfAnyOfCcHeader <RecipientIdParameter[]>] [-ExceptIfAnyOfCcHeaderMemberOf <RecipientIdParameter[]>] [-ExceptIfAnyOfRecipientAddressContainsWords <Word[]>] [-ExceptIfAnyOfRecipientAddressMatchesPatterns <Pattern[]>] [-ExceptIfAnyOfToCcHeader <RecipientIdParameter[]>] [-ExceptIfAnyOfToCcHeaderMemberOf <RecipientIdParameter[]>] [-ExceptIfAnyOfToHeader <RecipientIdParameter[]>] [-ExceptIfAnyOfToHeaderMemberOf <RecipientIdParameter[]>] [-ExceptIfAttachmentContainsWords <Word[]>] [-ExceptIfAttachmentExtensionMatchesWords <Word[]>] [-ExceptIfAttachmentHasExecutableContent <$true | $false>] [-ExceptIfAttachmentIsPasswordProtected <$true | $false>] [-ExceptIfAttachmentIsUnsupported <$true | $false>] [-ExceptIfAttachmentMatchesPatterns <Pattern[]>] [-ExceptIfAttachmentNameMatchesPatterns <Pattern[]>] [-ExceptIfAttachmentProcessingLimitExceeded <$true | $false>] [-ExceptIfAttachmentPropertyContainsWords <Word[]>] [-ExceptIfAttachmentSizeOver <ByteQuantifiedSize>] [-ExceptIfBetweenMemberOf1 <RecipientIdParameter[]>] [-ExceptIfBetweenMemberOf2 <RecipientIdParameter[]>] [-ExceptIfContentCharacterSetContainsWords <Word[]>] [-ExceptIfFrom <RecipientIdParameter[]>] [-ExceptIfFromAddressContainsWords <Word[]>] [-ExceptIfFromAddressMatchesPatterns <Pattern[]>] [-ExceptIfFromMemberOf <RecipientIdParameter[]>] [-ExceptIfFromScope <InOrganization | NotInOrganization>] [-ExceptIfHasClassification <String>] [-ExceptIfHasNoClassification <$true | $false>] [-ExceptIfHasSenderOverride <$true | $false>] [-ExceptIfHeaderContainsMessageHeader <HeaderName>] [-ExceptIfHeaderContainsWords <Word[]>] [-ExceptIfHeaderMatchesMessageHeader <HeaderName>] [-ExceptIfHeaderMatchesPatterns <Pattern[]>] [-ExceptIfManagerAddresses <RecipientIdParameter[]>] [-ExceptIfManagerForEvaluatedUser <Sender | Recipient>] [-ExceptIfMessageContainsAllDataClassifications <Hashtable[]>] [-ExceptIfMessageContainsDataClassifications <Hashtable[]>] [-ExceptIfMessageSizeOver <ByteQuantifiedSize>] [-ExceptIfMessageTypeMatches <OOF | AutoForward | Encrypted | Calendaring | PermissionControlled | Voicemail | Signed | ApprovalRequest | ReadReceipt>] [-ExceptIfRecipientADAttributeContainsWords <Word[]>] [-ExceptIfRecipientADAttributeMatchesPatterns <Pattern[]>] [-ExceptIfRecipientAddressContainsWords <Word[]>] [-ExceptIfRecipientAddressMatchesPatterns <Pattern[]>] [-ExceptIfRecipientDomainIs <Word[]>] [-ExceptIfRecipientInSenderList <Word[]>] [-ExceptIfSCLOver <SclValue>] [-ExceptIfSenderADAttributeContainsWords <Word[]>] [-ExceptIfSenderADAttributeMatchesPatterns <Pattern[]>] [-ExceptIfSenderDomainIs <Word[]>] [-ExceptIfSenderInRecipientList <Word[]>] [-ExceptIfSenderIpRanges <MultiValuedProperty>] [-ExceptIfSenderManagementRelationship <Manager | DirectReport>] [-ExceptIfSentTo <RecipientIdParameter[]>] [-ExceptIfSentToMemberOf <RecipientIdParameter[]>] [-ExceptIfSentToScope <InOrganization | NotInOrganization | ExternalPartner | ExternalNonPartner>] [-ExceptIfSubjectContainsWords <Word[]>] [-ExceptIfSubjectMatchesPatterns <Pattern[]>] [-ExceptIfSubjectOrBodyContainsWords <Word[]>] [-ExceptIfSubjectOrBodyMatchesPatterns <Pattern[]>] [-ExceptIfWithImportance <Low | Normal | High>] [-ExpiryDate <DateTime>] [-From <RecipientIdParameter[]>] [-FromAddressContainsWords <Word[]>] [-FromAddressMatchesPatterns <Pattern[]>] [-FromMemberOf <RecipientIdParameter[]>] [-FromScope <InOrganization | NotInOrganization>] [-GenerateIncidentReport <RecipientIdParameter>] [-GenerateNotification <DisclaimerText>] [-HasClassification <String>] [-HasNoClassification <$true | $false>] [-HasSenderOverride <$true | $false>] [-HeaderContainsMessageHeader <HeaderName>] [-HeaderContainsWords <Word[]>] [-HeaderMatchesMessageHeader <HeaderName>] [-HeaderMatchesPatterns <Pattern[]>] [-IncidentReportContent <IncidentReportContent[]>] [-LogEventText <EventLogText>] [-ManagerAddresses <RecipientIdParameter[]>] [-ManagerForEvaluatedUser <Sender | Recipient>] [-MessageContainsAllDataClassifications <Hashtable[]>] [-MessageContainsDataClassifications <Hashtable[]>] [-MessageSizeOver <ByteQuantifiedSize>] [-MessageTypeMatches <OOF | AutoForward | Encrypted | Calendaring | PermissionControlled | Voicemail | Signed | ApprovalRequest | ReadReceipt>] [-Mode <Audit | AuditAndNotify | Enforce>] [-ModerateMessageByManager <$true | $false>] [-ModerateMessageByUser <RecipientIdParameter[]>] [-NotifySender <NotifyOnly | RejectMessage | RejectUnlessFalsePositiveOverride | RejectUnlessSilentOverride | RejectUnlessExplicitOverride>] [-OMEExpiryDays <Int32>] [-PrependSubject <SubjectPrefix>] [-Priority <Int32>] [-Quarantine <$true | $false>] [-RecipientADAttributeContainsWords <Word[]>] [-RecipientADAttributeMatchesPatterns <Pattern[]>] [-RecipientAddressContainsWords <Word[]>] [-RecipientAddressMatchesPatterns <Pattern[]>] [-RecipientDomainIs <Word[]>] [-RecipientInSenderList <Word[]>] [-RedirectMessageTo <RecipientIdParameter[]>] [-RejectMessageEnhancedStatusCode <RejectEnhancedStatus>] [-RejectMessageReasonText <DsnText>] [-RemoveHeader <HeaderName>] [-RemoveOME <$true | $false>] [-RouteMessageOutboundConnector <OutboundConnectorIdParameter>] [-RouteMessageOutboundRequireTls <$true | $false>] [-RuleErrorAction <Ignore | Defer>] [-RuleSubType <None | Dlp>] [-SCLOver <SclValue>] [-SenderADAttributeContainsWords <Word[]>] [-SenderADAttributeMatchesPatterns <Pattern[]>] [-SenderAddressLocation <Header | Envelope | HeaderOrEnvelope>] [-SenderDomainIs <Word[]>] [-SenderInRecipientList <Word[]>] [-SenderIpRanges <MultiValuedProperty>] [-SenderManagementRelationship <Manager | DirectReport>] [-SentTo <RecipientIdParameter[]>] [-SentToMemberOf <RecipientIdParameter[]>] [-SentToScope <InOrganization | NotInOrganization | ExternalPartner | ExternalNonPartner>] [-SetAuditSeverity <String>] [-SetHeaderName <HeaderName>] [-SetHeaderValue <HeaderValue>] [-SetSCL <SclValue>] [-SmtpRejectMessageRejectStatusCode <RejectStatusCode>] [-SmtpRejectMessageRejectText <RejectText>] [-StopRuleProcessing <$true | $false>] [-SubjectContainsWords <Word[]>] [-SubjectMatchesPatterns <Pattern[]>] [-SubjectOrBodyContainsWords <Word[]>] [-SubjectOrBodyMatchesPatterns <Pattern[]>] [-UseLegacyRegex <$true | $false>] [-WhatIf [<SwitchParameter>]] [-WithImportance <Low | Normal | High>]

```

## Examples
<a name="Examples"> </a>

### Example 1

This example creates a rule with the following settings:
  
- **Name**: Ethical Wall - Sales and Brokerage Departments
    
- **Conditions**: Messages that are sent between members of the groups named Sales Department and Brokerage Department.
    
- **Actions**: The message is rejected, and the custom rejection text is  `Messages sent between the Sales and Brokerage departments are strictly prohibited`. Note that the default enhanced status code  `5.7.1` is used, because we didn't use the _RejectMessageEnhancedStatusCode_ parameter.
    
- **Exceptions**: The **Subject** field contains the phrases `Press Release` or `Corporate Communication` **or** the message was sent by Tony Smith or Pilar Ackerman.
    
```
New-TransportRule "Ethical Wall - Sales and Brokerage Departments" -BetweenMemberOf1 "Sales Department" -BetweenMemberOf2 "Brokerage Department" -ExceptIfFrom "Tony Smith","Pilar Ackerman" -ExceptIfSubjectContainsWords "Press Release","Corporate Communication" -RejectMessageReasonText "Messages sent between the Sales and Brokerage departments are strictly prohibited."
```

## Detailed Description
<a name="DetailedDescription"> </a>

In on-premises Exchange organizations, rules created on Mailbox servers are stored in Active Directory. All Mailbox servers in the organization have access to the same set of rules. On Edge Transport servers, rules are saved in the local copy of Active Directory Lightweight Directory Services (AD LDS). Rules aren't shared or replicated between Edge Transport servers or between Mailbox servers and Edge Transport servers. Also, some conditions and actions are exclusive to each server role.
  
> [!NOTE]
> The search for words or text patterns in the subject or other header fields in the message occurs  *after*  the message has been decoded from the MIME content transfer encoding method that was used to transmit the binary message between SMTP servers in ASCII text. You can't use conditions or exceptions to search for the raw (typically, Base64) encoded values of the subject or other header fields in messages.
  
You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://technet.microsoft.com/library/mt432940.aspx).
  
## Parameters
<a name="DetailedDescription"> </a>

|**Parameter**|**Required**|**Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _Name_ <br/> |Required  <br/> |System.String  <br/> |The _Name_ parameter specifies the unique name of the rule. The maximum length is 64 characters. If the value contains spaces, enclose the value in quotation marks ("). <br/> |
| _ActivationDate_ <br/> |Optional  <br/> |System.DateTime  <br/> |The _ActivationDate_ parameter specifies when the rule starts processing messages. The rule won't take any action on messages until the specified date/time. <br/> Use the short date format that's defined in the **Regional Options** settings on the computer where you're running the command. For example, if the computer is configured to use the short date format _mm_/ _dd_/ _yyyy_, enter 09/01/2015 to specify September 1, 2015. You can enter the date only, or you can enter the date and time of day. If you enter the date and time of day, enclose the value in quotation marks ("), for example,"09/01/2015 5:00 PM".  <br/> |
| _ADComparisonAttribute_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ADAttribute  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _ADComparisonAttribute_ parameter specifies a condition that compares an Active Directory attribute between the sender and all recipients of the message. This parameter works when the recipients are individual users. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  If you don't use the _ADComparisonOperator_ parameter, the default comparison operator `Equal` is used. <br/> |
| _ADComparisonOperator_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Evaluation  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _ADComparisonOperator_ parameter specifies the comparison operator for the _ADComparisonAttribute_ parameter. Valid values are: <br/>  `Equal` (This is the default value) <br/>  `NotEqual` <br/> |
| _AddManagerAsRecipientType_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.AddedRecipientType  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _AddManagerAsRecipientType_ parameter specifies an action that delivers or redirects messages to the user that's defined in the sender's **Manager** attribute. Valid values are: <br/>  `To`: Add the sender's manager to the **To** field of the message. <br/>  `Cc`: Add the sender's manager to the **Cco** field of the message. <br/>  `Bcc`: Add the sender's manager to the **Bcc** field of the message. <br/>  `Redirect`: Redirect the message to the sender's manager without notifying the sender or the recipients.  <br/>  This action only works if the sender's **Manager** attribute is defined. <br/> |
| _AddToRecipients_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _AddToRecipients_ parameter specifies an action that adds recipients to the **To** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _AnyOfCcHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfCcHeader_ parameter specifies a condition that looks for recipients in the **Cc** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfCcHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfCcHeaderMemberOf_ parameter specifies a condition that looks for group members in the **Cc** field of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfRecipientAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _AnyOfRecipientAddressContainsWords_ parameter specifies a condition that looks for words in recipient email addresses. You can specify multiple words separated by commas. <br/> A match for this condition applies the rule action to  *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfRecipientAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _AnyOfRecipientAddressMatchesPatterns_ parameter specifies a condition that looks for text patterns in recipient email addresses by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> A match for this condition applies the rule action to  *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfToCcHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfToCcHeader_ parameter specifies a condition that looks for recipients in the **To** or **Cc** fields of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfToCcHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfToCcHeaderMemberOf_ parameter specifies a condition that looks for group members in the **To** and **Cc** fields of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfToHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfToHeader_ parameter specifies a condition that looks for recipients in the **To** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _AnyOfToHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AnyOfToHeaderMemberOf_ parameter specifies a condition that looks for group members in the **To** field of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this condition applies the rule action to *all*  recipients of the message. For example, if the action is to reject the message, the message is rejected for all recipients of the message, not just for the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ApplyClassification_ <br/> |Optional  <br/> |System.String  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Mailbox servers.  <br/> The _ApplyClassification_ parameter specifies an action that applies a message classification to messages. Use the **Get-MessageClassification** cmdlet to see the message classification objects that are available. <br/> > [!NOTE]> The message classification referred to in this parameter is the custom message classification that you can create in your organization by using the **New-MessageClassification** cmdlet. It isn't related to the data loss prevention (DLP) data classification.          |
| _ApplyHtmlDisclaimerFallbackAction_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.DisclaimerFallbackAction  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _ApplyHtmlDisclaimerFallbackAction_ parameter specifies what to do if the HTML disclaimer can't be added to a message. Valid values are: <br/>  `Wrap`: The original message is wrapped in a new message envelope, and the disclaimer is used as the message body for the new message. This is the default value. Subsequent mail flow rules are applied to the new message envelope, not to the original message. Therefore, configure a rule with this action at a lower priority (a higher priority number) than other rules. If the original message can't be wrapped in a new message envelope, the original message isn't delivered. The message is returned to the sender in an non-delivery report (also known as an NDR or bounce message).  <br/>  `Ignore`: The rule is ignored and the message is delivered without the disclaimer.  <br/>  `Reject`: The message is rejected.  <br/>  If you don't use this parameter with the _ApplyHtmlDisclaimerText_ parameter, the default value `Wrap` is used. <br/> |
| _ApplyHtmlDisclaimerLocation_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.DisclaimerLocation  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _ApplyHtmlDisclaimerLocation_ parameter specifies where to insert the HTML disclaimer text in the body of messages. Valid values are: <br/>  `Append`: The disclaimer is added to the end of the message body. This is the default value.  <br/>  `Prepend`: The disclaimer is inserted to the beginning of the message body.  <br/>  If you don't use this parameter with the _ApplyHtmlDisclaimerText_ parameter, the default value `Append` is used. <br/> |
| _ApplyHtmlDisclaimerText_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.DisclaimerText  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Mailbox servers.  <br/> The _ApplyHtmlDisclaimerText_ parameter specifies an action that adds the disclaimer text to messages. Disclaimer text can include HTML tags and inline cascading style sheet (CSS) tags. You can add images using the IMG tag. <br/> You use the _ApplyHtmlDisclaimerLocation_ parameter to specify where to insert the text in the message body (the default value is `Append`), and the _ApplyHtmlDisclaimerFallbackAction_ parameter to specify what to do if the disclaimer can't be added to the message (the default value is `Wrap`).  <br/> |
| _ApplyOME_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter is available only in the cloud-based service. <br/>  This parameter specifies an action or part of an action for the rule. <br/>  The _ApplyOME_ parameter specifies an action that encrypts messages and their attachments by using Office 365 Message Encryption. Valid values are: <br/>  `$true`: The message and attachments are encrypted.  <br/>  `$false`: The message and attachments aren't encrypted.  <br/> |
| _ApplyRightsProtectionTemplate_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RmsTemplateIdParameter  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Mailbox servers.  <br/> The _ApplyRightsProtectionTemplate_ parameter specifies an action that applies rights management service (RMS) templates to messages. You identify the RMS template by name. If the name contains spaces, enclose the name in quotation marks ("). <br/> To use this action, you need to have an Active Directory Rights Management Services (AD RMS) server in your organization, or your organization needs to use the ILS service.  <br/> Use the **Get-RMSTemplate** cmdlet to see the RMS templates that are available. <br/> For more information, see [Understanding Transport Protection Rules](https://technet.microsoft.com/library/9bd6d049-165e-4e51-a79f-3b8ff409da55.aspx).  <br/> |
| _AttachmentContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _AttachmentContainsWords_ parameter specifies a condition that looks for words in message attachments. Only supported attachment types are checked. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _AttachmentExtensionMatchesWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _AttachmentExtensionMatchesWords_ parameter specifies a condition that looks for words in the file name extensions of message attachments. You can specify multiple words separated by commas. <br/> |
| _AttachmentHasExecutableContent_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AttachmentHasExecutableContent_ parameter specifies a condition that looks for executable content in message attachments. Valid values are: <br/>  `$true`: Look for executable content in message attachments.  <br/>  `$false`: Don't look for executable content in message attachments.  <br/> |
| _AttachmentIsPasswordProtected_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AttachmentIsPasswordProtected_ parameter specifies a condition that looks for password protected files in messages (because the contents of the file can't be inspected). Password detection only works for Office documents and .zip files. Valid values are: <br/>  `$true`: Look for password protected attachments.  <br/>  `$false`: Don't look for password protected attachments.  <br/> |
| _AttachmentIsUnsupported_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AttachmentIsUnsupported_ parameter specifies a condition that looks for unsupported file types in messages. Unsupported file types are message attachments that aren't natively recognized by Exchange, and the required IFilter isn't installed. Valid values are: <br/>  `$true`: Look for unsupported file types in messages.  <br/>  `$false`: Don't look for unsupported file types in messages.  <br/>  For more information, see[Register Filter Pack IFilters with Exchange 2016](https://technet.microsoft.com/library/0338980f-3a64-49d3-bc3c-bf6f10f88cb4.aspx).  <br/> |
| _AttachmentMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _AttachmentMatchesPatterns_ parameter specifies a condition that looks for text patterns in the content of message attachments by using regular expressions. Only supported attachment types are checked. <br/> You can specify multiple text patterns by using the following syntax:  `"<regular expression1>","<regular expression2>",...`.  <br/> > [!NOTE]> Only the first 150 kilobytes (KB) of the attachment is scanned when trying to match a text pattern.           |
| _AttachmentNameMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _AttachmentNameMatchesPatterns_ parameter specifies a condition that looks for text patterns in the file name of message attachments by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _AttachmentProcessingLimitExceeded_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AttachmentProcessingLimitExceeded_ parameter specifies a condition that looks for messages where attachment scanning didn't complete. Valid values are: <br/>  `$true`: Look for messages where attachment scanning didn't complete.  <br/>  `$false`: Don't look for messages where attachment scanning didn't complete.  <br/>  You use this condition to create rules that work together with other attachment processing rules to handle messages where the content can't be fully scanned. <br/> |
| _AttachmentPropertyContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _AttachmentPropertyContainsWords_ parameter specifies a condition that looks for words in the properties of attached Office documents. This condition helps integrate mail flow rules (transport rules) with the File Classification Infrastructure (FCI) in Windows Server 2012 R2 or later, SharePoint, or a third-party classification system. Valid values are a built-in document property, or a custom property. The built-in document properties are: <br/> **Business Impact** <br/> **Compliancy** <br/> **Confidentiality** <br/> **Department** <br/> **Impact** <br/> **Intellectual Property** <br/> **Personally Identifiable Information** <br/> **Personal Information** <br/> **Personal Use** <br/> **Required Clearance** <br/> **PHI** <br/> **PII** <br/> **Project** <br/> **Protected Health Information** <br/>  This parameter uses the syntax: `"PropertyName:Word"`. To specify multiple properties, or multiple words for the same property, use the following syntax:  `"PropertyName1:Word1,Phrase with spaces,word2...","PropertyName2:Word3,Phrase with spaces,word4...`. Don't use leading or trailing spaces.  <br/>  When you specify multiple properties, or multiple values for the same property, the **or** operator is used. <br/> |
| _AttachmentSizeOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers. <br/>  The _AttachmentSizeOver_ parameter specifies a condition that looks for messages where any attachment is greater than the specified size. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/> |
| _BetweenMemberOf1_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _BetweenMemberOf1_ parameter specifies a condition that looks for messages that are sent between group members. You need to use this parameter with the _BetweenMemberOf2_ parameter. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _BetweenMemberOf2_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _BetweenMemberOf2_ parameter specifies a condition that looks for messages that are sent between group members. You need to use this parameter with the _BetweenMemberOf1_ parameter. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _BlindCopyTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _BlindCopyTo_ parameter specifies an action that adds recipients to the **Bcc** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _Comments_ <br/> |Optional  <br/> |System.String  <br/> |The _Comments_ parameter specifies optional descriptive text for the rule (for example, what the rule is used for, or how it has changed over time). The length of the comment can't exceed 1024 characters. If the value contains spaces, enclose the value in quotation marks ("). <br/> |
| _Confirm_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> | The _Confirm_ switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding. <br/>  Destructive cmdlets (for example, **Remove-\*** cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.  <br/>  Most other cmdlets (for example, **New-\*** and **Set-\*** cmdlets) don't have a built-in pause. For these cmdlets, specifying the _Confirm_ switch without a value introduces a pause that forces you acknowledge the command before proceeding. <br/> |
| _ContentCharacterSetContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _ContentCharacterSetContainsWords_ parameter specifies a condition that looks for character set names in messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _CopyTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _CopyTo_ parameter specifies an action that adds recipients to the **Cc** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _DeleteMessage_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _DeleteMessage_ parameter specifies an action that silently drops messages without an NDR. Valid values are: <br/>  `$true`: Silently drop the message without an NDR.  <br/>  `$false`: Don't silently drop the message.  <br/> |
| _Disconnect_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Edge Transport servers. <br/>  The _Disconnect_ parameter specifies an action that ends the SMTP connection between the sending server and the Edge Transport server without generating an NDR. <br/>  `$true`: Silently end the SMTP session without generating an NDR.  <br/>  `$false`: Don't silently end the SMTP session.  <br/> |
| _DlpPolicy_ <br/> |Optional  <br/> |System.String  <br/> |The _DlpPolicy_ parameter specifies the data loss prevention (DLP) policy that's associated with the rule. Each DLP policy is enforced using a set of mail flow rules (transport rules). To learn more about DLP, see[Understanding Data Loss Prevention](https://technet.microsoft.com/library/7c8ed3c1-ca91-4d9b-b16b-0a2b8ac89730.aspx).  <br/> |
| _DomainController_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Fqdn  <br/> |This parameter is available only in on-premises Exchange.  <br/> The _DomainController_ parameter specifies the domain controller that's used by this cmdlet to read data from or write data to Active Directory. You identify the domain controller by its fully qualified domain name (FQDN). For example, `dc01.contoso.com`.  <br/> The _DomainController_ parameter isn't supported on Edge Transport servers. An Edge Transport server uses the local instance of Active Directory Lightweight Directory Services (AD LDS) to read and write data. <br/> |
| _Enabled_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _Enabled_ parameter specifies whether the new rule is created as enabled or disabled. Valid values are: <br/>  `$true`: The new rule is enabled. This is the default value.  <br/>  `$false`: The new rule is disabled.  <br/>  To enable or disable a rule after you create it, use the **Enable-TransportRule** and **Disable-TransportRule** cmdlets. <br/> |
| _ExceptIfADComparisonAttribute_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ADAttribute  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfADComparisonAttribute_ parameter specifies an exception that compares an Active Directory attribute between the sender and all recipients of the message. This parameter works when the recipients are individual users. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  If you don't use the _ExceptIfADComparisonOperator_ parameter, the default comparison operator `Equal` is used. <br/> |
| _ExceptIfADComparisonOperator_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Evaluation  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfADComparisonOperator_ parameter specifies the comparison operator for the _ExceptIfADComparisonAttribute_ parameter. Valid values are: <br/>  `Equal` (This is the default value) <br/>  `NotEqual` <br/> |
| _ExceptIfAnyOfCcHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfCcHeader_ parameter specifies an exception that looks for recipients in the **Cc** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfCcHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfCcHeaderMemberOf_ parameter specifies an exception that looks for group members in the **Cc** field of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfRecipientAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfAnyOfRecipientAddressContainsWords_ parameter specifies an exception that looks for words in recipient email addresses. You can specify multiple words separated by commas. <br/> A match for this exception prevents the rule action from being applied to  *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfRecipientAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfAnyOfRecipientAddressMatchesPatterns_ parameter specifies an exception that looks for text patterns in recipient email addresses by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> A match for this exception prevents the rule action from being applied to  *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfToCcHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfToCcHeader_ parameter specifies an exception that looks for recipients in the **To** or **Cc** fields of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfToCcHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfToCcHeaderMemberOf_ parameter specifies an exception that looks for group members in the **To** and **Cc** fields of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfToHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfToHeader_ parameter specifies an exception that looks for recipients in the **To** field of messages. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAnyOfToHeaderMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAnyOfToHeaderMemberOf_ parameter specifies an exception that looks for group members in the **To** field of messages. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  A match for this exception prevents the rule action from being applied to *all*  recipients of the message. For example, if the action is to reject the message, the message is delivered to all recipients of the message, not just to the specified recipients. <br/> **Note**: This condition or exception doesn't consider messages that are sent to recipient proxy addresses. It only matches messages that are sent to the recipient's primary email address.  <br/> |
| _ExceptIfAttachmentContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfAttachmentContainsWords_ parameter specifies an exception that looks for words in message attachments. Only supported attachment types are checked. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _ExceptIfAttachmentExtensionMatchesWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfAttachmentExtensionMatchesWords_ parameter specifies an exception that looks for words in the file name extensions of message attachments. You can specify multiple words separated by commas. <br/> |
| _ExceptIfAttachmentHasExecutableContent_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAttachmentHasExecutableContent_ parameter specifies an exception that looks for executable content in message attachments. Valid values are: <br/>  `$true`: Look for executable content in message attachments.  <br/>  `$false`: Don't look for executable content in message attachments.  <br/> |
| _ExceptIfAttachmentIsPasswordProtected_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAttachmentIsPasswordProtected_ parameter specifies an exception that looks for password protected files in messages (because the contents of the file can't be inspected). Password detection only works for Office documents and .zip files. Valid values are: <br/>  `$true`: Look for password protected attachments.  <br/>  `$false`: Don't look for password protected attachments.  <br/> |
| _ExceptIfAttachmentIsUnsupported_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAttachmentIsUnsupported_ parameter specifies an exception that looks for unsupported file types in messages. Unsupported file types are message attachments that aren't natively recognized by Exchange, and the required IFilter isn't installed. Valid values are: <br/>  `$true`: Look for unsupported file types in messages.  <br/>  `$false`: Don't look for unsupported file types in messages.  <br/>  For more information, see[Register Filter Pack IFilters with Exchange 2016](https://technet.microsoft.com/library/0338980f-3a64-49d3-bc3c-bf6f10f88cb4.aspx).  <br/> |
| _ExceptIfAttachmentMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfAttachmentMatchesPatterns_ parameter specifies an exception that looks for text patterns in the content of message attachments by using regular expressions. Only supported attachment types are checked. <br/> You can specify multiple text patterns by using the following syntax:  `"<regular expression1>","<regular expression2>",...`.  <br/> > [!NOTE]> Only the first 150 KB of the attachment is scanned when trying to match a text pattern.           |
| _ExceptIfAttachmentNameMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfAttachmentNameMatchesPatterns_ parameter specifies an exception that looks for text patterns in the file name of message attachments by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _ExceptIfAttachmentProcessingLimitExceeded_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAttachmentProcessingLimitExceeded_ parameter specifies an exception that looks for messages where attachment scanning didn't complete. Valid values are: <br/>  `$true`: Look for messages where attachment scanning didn't complete.  <br/>  `$false`: Don't look for messages where attachment scanning didn't complete.  <br/>  You use this exception to create rules that work together with other attachment processing rules to handle messages where the content can't be fully scanned. <br/> |
| _ExceptIfAttachmentPropertyContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfAttachmentPropertyContainsWords_ parameter specifies an exception that looks for words in the properties of attached Office documents. This condition helps integrate rules with the File Classification Infrastructure (FCI) in Windows Server 2012 R2 or later, SharePoint, or a third-party classification system. Valid values are a built-in document property, or a custom property. The built-in document properties are: <br/> **Business Impact** <br/> **Compliancy** <br/> **Confidentiality** <br/> **Department** <br/> **Impact** <br/> **Intellectual Property** <br/> **Personally Identifiable Information** <br/> **Personal Information** <br/> **Personal Use** <br/> **Required Clearance** <br/> **PHI** <br/> **PII** <br/> **Project** <br/> **Protected Health Information** <br/>  The syntax for this parameter is `"PropertyName:Word"`. To specify multiple properties, or multiple words for the same property, use the following syntax:  `"PropertyName1:Word1,Phrase with spaces,word2...","PropertyName2:Word3,Phrase with spaces,word4...`. Don't use values with leading or trailing spaces.  <br/>  When you specify multiple properties, or multiple values for the same property, the **or** operator is used. <br/> |
| _ExceptIfAttachmentSizeOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers. <br/>  The _ExceptIfAttachmentSizeOver_ parameter specifies an exception that looks for messages where any attachment is greater than the specified size. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/> |
| _ExceptIfBetweenMemberOf1_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfBetweenMemberOf1_ parameter specifies an exception that looks for messages that are sent between group members. You need to use this parameter with the _ExceptIfBetweenMemberOf2_ parameter. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _ExceptIfBetweenMemberOf2_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfBetweenMemberOf2_ parameter specifies an exception that looks for messages that are sent between group members. You need to use this parameter with the _ExceptIfBetweenMemberOf1_ parameter. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _ExceptIfContentCharacterSetContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfContentCharacterSetContainsWords_ parameter specifies an exception that looks for character set names in messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _ExceptIfFrom_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfFrom_ parameter specifies an exception that looks for messages from specific senders. You can use any value that uniquely identifies the sender. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _ExceptIfFromAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfFromAddressContainsWords_ parameter specifies an exception that looks for words in the sender's email address. You can specify multiple words separated by commas. <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _ExceptIfFromAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfFromAddressMatchesPatterns_ parameter specifies an exception that looks for text patterns in the sender's email address by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _ExceptIfFromMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfFromMemberOf_ parameter specifies an exception that looks for messages sent by group members. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _ExceptIfFromScope_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.FromUserScope  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers. <br/>  The _ExceptIfFromScope_ parameter specifies an exception that looks for the location of message senders. Valid values are: <br/>  `InOrganization`: The sender is a mailbox, mail user, group, or mail-enabled public folder in your organization **or** The sender's email address is in an accepted domain that's configured as an authoritative domain or an internal relay domain, **and** the message was sent or received over an authenticated connection. <br/>  `NotInOrganization`: The sender's email address isn't in an accepted domain **or** the sender's email address is in an accepted domain that's configured as an external relay domain. <br/> |
| _ExceptIfHasClassification_ <br/> |Optional  <br/> |System.String  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfHasClassification_ parameter specifies an exception that looks for messages with the specified message classification. <br/> You use the **Get-MessageClassification** cmdlet to identify the message classification. For example, to find messages with the `Company Internal` classification, use the following syntax: <br/>  `-ExceptIfHasClassification @(Get-MessageClassification "Company Internal").Identity` <br/> > [!NOTE]> The message classification referred to in this parameter is the custom message classification that you can create in your organization by using the **New-MessageClassification** cmdlet. It isn't related to the DLP data classification.          |
| _ExceptIfHasNoClassification_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfHasNoClassification_ parameter specifies an exception that looks for messages with or without any message classifications. Valid values are: <br/>  `$true`: Look for messages that don't have a message classification.  <br/>  `$false`: Look for messages that have one or more message classifications.  <br/> |
| _ExceptIfHasSenderOverride_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfHasSenderOverride_ parameter specifies an exception that looks for messages where the sender chose to override a DLP policy. Valid values are: <br/>  `$true`: Look for messages where the sender took action to override a DLP policy.  <br/>  `$false`: Don't look for messages where the sender took action to override a DLP policy.  <br/> |
| _ExceptIfHeaderContainsMessageHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfHeaderContainsMessageHeader_ parameter specifies the name of header field in the message header when searching for the words specified by the _ExceptIfHeaderContainsWords_ parameter. <br/> |
| _ExceptIfHeaderContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfHeaderContainsWords_ parameter specifies an exception that looks for words in a header field. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/>  You specify the header field to search by using the _ExceptIfHeaderContainsMessageHeader_ parameter. <br/> |
| _ExceptIfHeaderMatchesMessageHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfHeaderMatchesMessageHeader_ parameter specifies the name of header field in the message header when searching for the text patterns specified by the _ExceptIfHeaderMatchesPatterns_ parameter. <br/> |
| _ExceptIfHeaderMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfHeaderMatchesPatterns_ parameter specifies an exception that looks for text patterns in a header field by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/>  You specify the header field to search by using the _ExceptIfHeaderMatchesMessageHeader_ parameter. <br/> |
| _ExceptIfManagerAddresses_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfManagerAddresses_ parameter specifies the users (managers) for the _ExceptIfManagerForEvaluatedUser_ parameter. You can use any value that uniquely identifies the user. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You specify if you want to look for these users as managers of senders or recipients by using the _ExceptIfManagerForEvaluatedUser_ parameter. <br/> |
| _ExceptIfManagerForEvaluatedUser_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.EvaluatedUser  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfManagerForEvaluatedUser_ parameter specifies an exception that looks for users in the **Manager** attribute of senders or recipients. Valid values are: <br/>  `Recipient`: The user is the manager of a recipient.  <br/>  `Sender`: The user is the manager of the sender.  <br/>  You specify the users to look for by using the _ExceptIfManagerAddresses_ parameter. <br/> |
| _ExceptIfMessageContainsAllDataClassifications_ <br/> |Optional  <br/> |System.Collections.Hashtable[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _ExceptIfMessageContainsDataClassifications_ <br/> |Optional  <br/> |System.Collections.Hashtable[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfMessageContainsDataClassifications_ parameter specifies an exception that looks for sensitive information types in the body of messages, and in any attachments. <br/> This parameter uses the syntax  `@{<SensitiveInformationType1>},@{<SensitiveInformationType2>},...`. For example, to look for content that contains at least two credit card numbers, and at least one ABA routing number, use the value  `@{Name="Credit Card Number"; minCount="2"},@{Name="ABA Routing Number"; minCount="1"}`.  <br/>  For a list of sensitive information types available, see[Classification Rule Inventory](https://technet.microsoft.com/library/98b81f9c-87bb-4905-8e53-04621c3ae74d.aspx).  <br/> |
| _ExceptIfMessageSizeOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers. <br/>  The _ExceptIfMessageSizeOver_ parameter specifies an exception that looks for messages larger than the specified size. The size includes the message and all attachments. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/> |
| _ExceptIfMessageTypeMatches_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.MessageType  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfMessageTypeMatches_ parameter specifies an exception that looks for messages of the specified type. Valid values are: <br/>  `OOF`: Auto-reply messages configured by the user.  <br/>  `AutoForward`: Messages automatically forwarded to an alternative recipient (by Exchange, not by auto-forwarding rules that users configure in Outlook or Outlook).  <br/>  `Encrypted`: Encrypted messages.  <br/>  `Calendaring`: Meeting requests and responses.  <br/>  `PermissionControlled`: Messages that have specific permissions configured.  <br/>  `Voicemail`: Voice mail messages forwarded by Unified Messaging service.  <br/>  `Signed`: Digitally signed messages.  <br/>  `ApprovalRequest`: Moderations request messages sent to moderators.  <br/>  `ReadReceipt`: Read receipts.  <br/> |
| _ExceptIfRecipientADAttributeContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfRecipientADAttributeContainsWords_ parameter specifies an exception that looks for words in the Active Directory attributes of recipients. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Word"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Word1,Phrase with spaces,word2...","AttributeName2:Word3,Phrase with spaces,word4...`. Don't use words with leading or trailing spaces.  <br/>  For example, `"City:San Francisco,Palo Alto"` or `"City:San Francisco,Palo Alto"`, `"Department:Sales,Finance"`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _ExceptIfRecipientADAttributeMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfRecipientADAttributeMatchesPatterns_ parameter specifies an exception that looks for text patterns in the Active Directory attributes of recipients by using regular expressions. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Regular Expression"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Regular Expression1,Regular Expression2...","AttributeName2:Regular Expression3,Regular Expression4..."`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _ExceptIfRecipientAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfRecipientAddressContainsWords_ parameter specifies an exception that looks for words in recipient email addresses. You can specify multiple words separated by commas. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/> |
| _ExceptIfRecipientAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfRecipientAddressMatchesPatterns_ parameter specifies an exception that looks for text patterns in recipient email addresses by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups.  <br/> |
| _ExceptIfRecipientDomainIs_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfRecipientDomainIs_ parameter specifies an exception that looks for recipients with email address in the specified domains. You can specify multiple domains separated by commas. <br/> If you want to look for recipient email addresses that  *contain*  the specified domain (for example, any subdomain of a domain), use the _ExceptIfRecipientAddressMatchesPatterns_ parameter, and specify the domain by using the syntax `'@domain\.com$'`.  <br/> |
| _ExceptIfRecipientInSenderList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _ExceptIfSCLOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SclValue  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers. <br/>  The _ExceptIfSCLOver_ parameter specifies an exception that looks for the SCL value of messages. Valid values are: <br/>  `-1`: The message is from a trusted sender, so the message bypasses spam filtering.  <br/>  Integers `0` through `9`: A higher value indicates that a message is more likely to be spam.  <br/>  The rule looks for messages with an SCL value that's greater than or equal to the specified value. <br/> |
| _ExceptIfSenderADAttributeContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSenderADAttributeContainsWords_ parameter specifies an exception that looks for words in Active Directory attributes of message senders. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Word"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Word1,Phrase with spaces,word2...","AttributeName2:Word3,Phrase with spaces,word4...`. Don't use words with leading or trailing spaces.  <br/>  For example, `"City:San Francisco,Palo Alto"` or `"City:San Francisco,Palo Alto"`, `"Department:Sales,Finance"`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _ExceptIfSenderADAttributeMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSenderADAttributeMatchesPatterns_ parameter specifies an exception that looks for text patterns in Active Directory attributes of message senders by using regular expressions. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Regular Expression"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Regular Expression1,Regular Expression2...","AttributeName2:Regular Expression3,Regular Expression4..."`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _ExceptIfSenderDomainIs_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is only available on Mailbox servers.  <br/> The _ExceptIfSenderDomainIs_ parameter specifies an exception that looks for senders with email address in the specified domains. You can specify multiple domains separated by commas. <br/> If you want to look for sender email addresses that  *contain*  the specified domain (for example, any subdomain of a domain), use the _FromAddressMatchesPatterns_ parameter, and specify the domain by using the syntax `'@domain\.com$'`.  <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _ExceptIfSenderInRecipientList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _ExceptIfSenderIpRanges_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSenderIpRanges_ parameter specifies an exception that looks for senders whose IP addresses matches the specified value, or fall within the specified ranges. Valid values are: <br/> **Single IP address**: For example,  `192.168.1.1`.  <br/> **IP address range**: For example,  `192.168.0.1-192.168.0.254`.  <br/> **Classless InterDomain Routing (CIDR) IP address range**: For example,  `192.168.0.1/25`.  <br/>  You can specify multiple IP addresses or ranges separated by commas. <br/> |
| _ExceptIfSenderManagementRelationship_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ManagementRelationship  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSenderManagementRelationship_ parameter specifies an exception that looks for the relationship between the sender and recipients in messages. Valid values are: <br/>  `Manager`: The sender is the manager of a recipient.  <br/>  `DirectReport`: A recipient is the manager of the sender.  <br/> |
| _ExceptIfSentTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSentTo_ parameter specifies an exception that looks for recipients in messages. You can use any value that uniquely identifies the recipient. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  Display name <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _ExceptIfSentToMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  The _ExceptIfSentToMemberOf_ parameter specifies an exception that looks for messages sent to members of groups. You can use any value that uniquely identifies the group. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  Display name <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> > [!NOTE]>  If you remove the group after you create the rule, no exception is made for messages that are sent to members of the group.          |
| _ExceptIfSentToScope_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ToUserScope  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfSentToScope_ parameter specifies an exception that looks for the location of a recipient. Valid values are: <br/>  `InOrganization`: The recipient is a mailbox, mail user, group, or mail-enabled public folder in your organization **or** the recipient's email address is in an accepted domain that's configured as an authoritative domain or an internal relay domain, **and** the message was sent or received over an authenticated connection. <br/>  `NotInOrganization`: The recipients are outside your organization. The recipient's email address isn't in an accepted domain **or** the recipient's email address is in an accepted domain that's configured as an external relay domain. <br/>  `ExternalPartner`: The recipients are in a partner organization where you've configured Domain Security (mutual TLS authentication) to send mail. This value is only available in on-premises Exchange.  <br/>  `ExternalNonPartner`: The recipients are external to your organization, and the organization isn't a partner organization. This value is only available in on-premises Exchange.  <br/> |
| _ExceptIfSubjectContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfSubjectContainsWords_ parameter specifies an exception that looks for words in the **Subject** field of messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _ExceptIfSubjectMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfSubjectMatchesPatterns_ parameter specifies an exception that looks for text patterns in the **Subject** field of messages by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _ExceptIfSubjectOrBodyContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfSubjectOrBodyContainsWords_ parameter specifies an exception that looks for words in the **Subject** field or body of messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _ExceptIfSubjectOrBodyMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> In on-premises Exchange, this exception is available on Mailbox servers and Edge Transport servers.  <br/> The _ExceptIfSubjectOrBodyMatchesPatterns_ parameter specifies an exception that looks for text patterns in the **Subject** field or body of messages. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _ExceptIfWithImportance_ <br/> |Optional  <br/> |Microsoft.Exchange.Management.Tasks.Importance  <br/> | This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/>  In on-premises Exchange, this exception is only available on Mailbox servers. <br/>  The _ExceptIfWithImportance_ parameter specifies an exception that looks for messages with the specified importance level. Valid values are: <br/>  `Low` <br/>  `Normal` <br/>  `High` <br/> |
| _ExpiryDate_ <br/> |Optional  <br/> |System.DateTime  <br/> |This parameter specifies an exception or part of an exception for the rule. The name of the corresponding condition doesn't include the _ExceptIf_ prefix. <br/> The _ExpiryDate_ parameter specifies when this rule will stop processing messages. The rule won't take any action on messages after the specified date/time. <br/> Use the short date format that's defined in the **Regional Options** settings on the computer where you're running the command. For example, if the computer is configured to use the short date format _mm_/ _dd_/ _yyyy_, enter 09/01/2015 to specify September 1, 2015. You can enter the date only, or you can enter the date and time of day. If you enter the date and time of day, enclose the value in quotation marks ("), for example,"09/01/2015 5:00 PM".  <br/> |
| _From_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _From_ parameter specifies a condition that looks for messages from specific senders. You can use any value that uniquely identifies the sender. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _FromAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _FromAddressContainsWords_ parameter specifies a condition that looks for words in the sender's email address. You can specify multiple words separated by commas. <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _FromAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _FromAddressMatchesPatterns_ parameter specifies a condition that looks for text patterns in the sender's email address by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _FromMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _FromMemberOf_ parameter specifies a condition that looks for messages sent by group members. You can use any value that uniquely identifies the group. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _FromScope_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.FromUserScope  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers. <br/>  The _FromScope_ parameter specifies a condition that looks for the location of message senders. Valid values are: <br/>  `InOrganization`: The sender is a mailbox, mail user, group, or mail-enabled public folder in your organization **or** The sender's email address is in an accepted domain that's configured as an authoritative domain or an internal relay domain, **and** the message was sent or received over an authenticated connection. <br/>  `NotInOrganization`: The sender's email address isn't in an accepted domain **or** the sender's email address is in an accepted domain that's configured as an external relay domain. <br/> |
| _GenerateIncidentReport_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _GenerateIncidentReport_ parameter specifies where to send the incident report that's defined by the _IncidentReportContent_ parameter. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  An incident report is generated for messages that violate a DLP policy in your organization. <br/> |
| _GenerateNotification_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.DisclaimerText  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _GenerateNotification_ parameter specifies an action that sends a notification message to recipients. For example, you can use this parameter to notify recipients that a message was rejected by the rule, or marked as spam and delivered to their Junk Email folder. <br/>  This parameter supports plain text, HTML tags and the following keywords that use values from the original message: <br/>  `%%From%%` <br/>  `%%To%%` <br/>  `%%Cc%%` <br/>  `%%Subject%%` <br/>  `%%Headers%%` <br/>  `%%MessageDate%%` <br/> |
| _HasClassification_ <br/> |Optional  <br/> |System.String  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _HasClassification_ parameter specifies a condition that looks for messages with the specified message classification. <br/> You use the **Get-MessageClassification** cmdlet to identify the message classification. For example, to find messages with the `Company Internal` classification, use the following syntax: <br/>  `-HasClassification @(Get-MessageClassification "Company Internal").Identity` <br/> > [!NOTE]> The message classification referred to in this parameter is the custom message classification that you can create in your organization by using the **New-MessageClassification** cmdlet. It isn't related to the DLP classification.          |
| _HasNoClassification_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _HasNoClassification_ parameter specifies a condition that looks for messages with or without any message classifications. Valid values are: <br/>  `$true`: Look for messages that don't have a message classification.  <br/>  `$false`: Look for messages that have one or more message classifications.  <br/> |
| _HasSenderOverride_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _HasSenderOverride_ parameter specifies a condition that looks for messages where the sender chose to override a DLP policy. Valid values are: <br/>  `$true`: Look for messages where the sender took action to override a DLP policy.  <br/>  `$false`: Don't look for messages where the sender took action to override a DLP policy.  <br/> |
| _HeaderContainsMessageHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _HeaderContainsMessageHeader_ parameter specifies the name of header field in the message header when searching for the words specified by the _HeaderContainsWords_ parameter. <br/> |
| _HeaderContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _HeaderContainsWords_ parameter specifies a condition that looks for words in a header field. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/>  You specify the header field to search by using the _HeaderContainsMessageHeader_ parameter. <br/> |
| _HeaderMatchesMessageHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _HeaderMatchesMessageHeader_ parameter specifies the name of header field in the message header when searching for the text patterns specified by the _HeaderMatchesPatterns_ parameter. <br/> |
| _HeaderMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _HeaderMatchesPatterns_ parameter specifies a condition that looks for text patterns in a header field by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> You specify the header field to search by using the _HeaderMatchesMessageHeader_ parameter. <br/> |
| _IncidentReportContent_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.IncidentReportContent[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _IncidentReportContent_ parameter specifies the message properties that are included in the incident report that's generated when a message violates a DLP policy. Valid values are: <br/>  `Sender`: The sender of the message.  <br/>  `Recipients`: The recipients in the **To** field of the message. Only the first 10 recipients are displayed in the incident report. If there are more than 10 recipients, the remaining number of recipients will be displayed. <br/>  `Subject`: The **Subject** field of the message. <br/>  `CC`: The recipients in the **Cc** field of the message. Only the first 10 recipients are displayed in the incident report. If there are more than 10 recipients, the remaining number of recipients will be displayed. <br/>  `BCC`: The recipients in the **Bcc** field of the message. Only the first 10 recipients are displayed in the incident report. If there are more than 10 recipients, the remaining number of recipients will be displayed. <br/>  `Severity`: The audit severity of the rule that was triggered. If the message was processed by more than one rule, the highest severity is displayed.  <br/>  `Override`: The override if the sender chose to override a PolicyTip. If the sender provided a justification, the first 100 characters of the justification is also included.  <br/>  `RuleDetections`: The list of rules that the message triggered.  <br/>  `FalsePositive`: The false positive if the sender marked the message as a false positive for a PolicyTip.  <br/>  `DataClassifications`: The list of sensitive information types that were detected in the message.  <br/>  `IdMatch`: The sensitive information type that was detected, the exact matched content from the message, and the 150 characters before and after the matched sensitive information.  <br/>  `AttachOriginalMail`: The entire original message as an attachment.  <br/> > [!NOTE]>  The message ID is always included in the incident report.           You can specify multiple values separated by commas. <br/>  You use this parameter with the _GenerateIncidentReport_ parameter. <br/> |
| _LogEventText_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.EventLogText  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Edge Transport servers. <br/>  The _LogEventText_ parameter specifies an action that creates an entry in the Application log on the local Edge Transport server. The value for this parameter specifies the text that you want to include in the event log entry. If the text contains spaces, enclose the value in quotation marks ("). <br/>  The entry contains the following information: <br/> **Level**:  `Information` <br/> **Source**:  `MSExchange Messaging Policies` <br/> **Event ID**:  `4000` <br/> **Task Category**:  `Rules` <br/> **EventData**:  `The following message is logged by an action in the rules: <text you specify>` <br/> |
| _ManagerAddresses_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _ManagerAddresses_ parameter specifies the users (managers) for the _ExceptIfManagerForEvaluatedUser_ parameter. You can use any value that uniquely identifies the user. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You specify if you want to look for these users as managers of senders or recipients by using the _ManagerForEvaluatedUser_ parameter. <br/> |
| _ManagerForEvaluatedUser_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.EvaluatedUser  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _ManagerForEvaluatedUser_ parameter specifies a condition that looks for users in the **Manager** attribute of senders or recipients. Valid values are: <br/>  `Recipient`: The user is the manager of a recipient.  <br/>  `Sender`: The user is the manager of the sender.  <br/>  You specify the users to look for by using the _ManagerAddresses_ parameter. <br/> |
| _MessageContainsAllDataClassifications_ <br/> |Optional  <br/> |System.Collections.Hashtable[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _MessageContainsDataClassifications_ <br/> |Optional  <br/> |System.Collections.Hashtable[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _MessageContainsDataClassifications_ parameter specifies a condition that looks for sensitive information types in the body of messages, and in any attachments. <br/> This parameter uses the syntax  `@{<SensitiveInformationType1>},@{<SensitiveInformationType2>},...`. For example, to look for content that contains at least two credit card numbers, and at least one ABA routing number, use the value  `@{Name="Credit Card Number"; minCount="2"},@{Name="ABA Routing Number"; minCount="1"}`.  <br/>  For a list of sensitive information types available, see[Classification Rule Inventory](https://technet.microsoft.com/library/98b81f9c-87bb-4905-8e53-04621c3ae74d.aspx).  <br/> You can specify the notification options by using the _NotifySender_ parameter. <br/> |
| _MessageSizeOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.ByteQuantifiedSize  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers. <br/>  The _MessageSizeOver_ parameter specifies a condition that looks for messages larger than the specified size. The size includes the message and all attachments. <br/>  When you enter a value, qualify the value with one of the following units: <br/>  `B` (bytes) <br/>  `KB` (kilobytes) <br/>  `MB` (megabytes) <br/>  `GB` (gigabytes) <br/>  `TB` (terabytes) <br/>  Unqualified values are typically treated as bytes, but small values may be rounded up to the nearest kilobyte. <br/> |
| _MessageTypeMatches_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.MessageType  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _MessageTypeMatches_ parameter specifies a condition that looks for messages of the specified type. Valid values are: <br/>  `OOF`: Auto-reply messages configured by the user.  <br/>  `AutoForward`: Messages automatically forwarded to an alternative recipient (by Exchange, not by auto-forwarding rules that users configure in Outlook or Outlook).  <br/>  `Encrypted`: Encrypted messages.  <br/>  `Calendaring`: Meeting requests and responses.  <br/>  `PermissionControlled`: Messages that have specific permissions configured.  <br/>  `Voicemail`: Voice mail messages forwarded by Unified Messaging service.  <br/>  `Signed`: Digitally signed messages.  <br/>  `ApprovalRequest`: Moderations request messages sent to moderators.  <br/>  `ReadReceipt`: Read receipts.  <br/> |
| _Mode_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.RuleMode  <br/> | The _Mode_ parameter specifies how the rule operates. Valid values are: <br/>  `Audit`: The actions that the rule would have taken are written to the message tracking log, but no any action is taken on the message that would impact delivery.  <br/>  `AuditAndNotify`: The rule operates the same as in  `Audit` mode, but notifications are also enabled. <br/>  `Enforce`: All actions specified in the rule are taken. This is the default value.  <br/> |
| _ModerateMessageByManager_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _ModerateMessageByManager_ parameter specifies an action that forwards messages for approval to the user that's specified in the sender's **Manager** attribute. After the manager approves the message, it's delivered to the recipients. Valid values are: <br/>  `$true`: Moderation by the sender's manager is enabled.  <br/>  `$false`: Moderation by the sender's manager is disabled.  <br/>  This action only works if the sender's **Manager** attribute is defined. <br/> |
| _ModerateMessageByUser_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _ModerateMessageByUser_ parameter specifies an action that forwards messages for approval to the specified users. After one of the users approves the message, it's delivered to the recipients. You can use ay value that uniquely identifies the user. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/>  You can't use a distribution group as a moderator. <br/> |
| _NotifySender_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.NotifySenderType  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _NotifySender_ parameter specifies an action that notifies the sender when messages violate DLP policies. Valid values are: <br/>  `NotifyOnly`: The sender is notified, but the message is delivered normally.  <br/>  `RejectMessage`: The message is rejected, and the sender is notified.  <br/>  `RejectUnlessFalsePositiveOverride`: The message is rejected unless it's marked as a false positive by the sender.  <br/>  `RejectUnlessSilentOverride`: The message is rejected unless the sender has chosen to override the policy restriction.  <br/>  `RejectUnlessExplicitOverride`: This is the same as  `RejectUnlessSilentOverride`, but the sender can also provide a justification for overriding the policy restriction.  <br/>  For all values except `NotifyOnly`, you can specify an enhanced status code and a rejection reason by using the _RejectMessageEnhancedStatusCode_ and _RejectMessageReasonText_ parameters. The default enhanced status code is `5.7.1`, and the default rejection reason is  `Delivery not authorized, message refused`.  <br/>  If you use this parameter, you also need to specify a condition that looks for sensitive information types in messages by using the _MessageContainsDataClassifications_ parameter. <br/> |
| _OMEExpiryDays_ <br/> |Optional  <br/> |System.Int32  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _PrependSubject_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SubjectPrefix  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers.  <br/> The _PrependSubject_ parameter specifies an action that adds text to add to the beginning of the **Subject** field of messages. The value for this parameter is the text that you want to add. If the text contains spaces, enclose the value in quotation marks (")> <br/> > [!NOTE]> Consider ending the value for this parameter with a colon (:) and a space, or at least a space, to separate it from the original subject.           |
| _Priority_ <br/> |Optional  <br/> |System.Int32  <br/> | The _Priority_ parameter specifies a priority value for the rule that determines the order of rule processing. A lower integer value indicates a higher priority, the value 0 is the highest priority, and rules can't have the same priority value. <br/>  Valid values and the default value for this parameter depend on the number of existing rules. For example, if there are 8 existing rules: <br/>  Valid priority values for the existing 8 rules are from 0 through 7. <br/>  Valid priority values for a new rule (the 9th rule) are from 0 through 8. <br/>  The default value for a new rule (the 9th rule) is 8. <br/>  If you modify the priority value of a rule, the position of the rule in the list changes to match the priority value you specify. In other words, if you set the priority value of a rule to the same value as an existing rule, the priority value of the existing rule and all other lower priority rules after it is increased by 1. <br/> |
| _Quarantine_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Edge Transport servers. <br/>  The _Quarantine_ parameter specifies an action that quarantines messages. <br/>  In on-premises Exchange, messages are delivered to the quarantine mailbox that you've configured as part of Content filtering. If the quarantine mailbox isn't configured, the message is returned to the sender in an NDR. <br/>  In Office 365, messages are delivered to the hosted quarantine. <br/> |
| _RecipientADAttributeContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _RecipientADAttributeContainsWords_ parameter specifies a condition that looks for words in the Active Directory attributes of recipients. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Word"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Word1,Phrase with spaces,word2...","AttributeName2:Word3,Phrase with spaces,word4...`. Don't use words with leading or trailing spaces.  <br/>  For example, `"City:San Francisco,Palo Alto"` or `"City:San Francisco,Palo Alto"`, `"Department:Sales,Finance"`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _RecipientADAttributeMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _RecipientADAttributeMatchesPatterns_ parameter specifies a condition that looks for text patterns in the Active Directory attributes of recipients by using regular expressions. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Regular Expression"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Regular Expression1,Regular Expression2...","AttributeName2:Regular Expression3,Regular Expression4..."`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _RecipientAddressContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _RecipientAddressContainsWords_ parameter specifies a condition that looks for words in recipient email addresses. You can specify multiple words separated by commas. This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups. <br/> |
| _RecipientAddressMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _RecipientAddressMatchesPatterns_ parameter specifies a condition that looks for text patterns in recipient email addresses by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> This parameter works when the recipient is an individual user. This parameter doesn't work with distribution groups.  <br/> |
| _RecipientDomainIs_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _RecipientDomainIs_ parameter specifies a condition that looks for recipients with email address in the specified domains. You can specify multiple domains separated by commas. <br/> If you want to look for recipient email addresses that  *contain*  the specified domain (for example, any subdomain of a domain), use the _RecipientAddressMatchesPatterns_ parameter, and specify the domain by using the syntax `'@domain\.com$'`.  <br/> |
| _RecipientInSenderList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _RedirectMessageTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _RedirectMessageTo_ parameter specifies a rule action that redirects messages to the specified recipients. You can use any value that uniquely identifies the recipient. <br/>  For example: <br/>  Name <br/>  Display name <br/>  Alias <br/>  Distinguished name (DN) <br/>  Canonical DN <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _RejectMessageEnhancedStatusCode_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.RejectEnhancedStatus  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Mailbox servers.  <br/> The _RejectMessageEnhancedStatusCode_ parameter specifies the enhanced status code that's used when the rule rejects messages. Valid values are `5.7.1` or between `5.7.900` and `5.7.999`.  <br/> You can use this parameter with the _NotifySender_ and _RejectMessageReasonText_ parameters to specify the custom enhanced status code that's used. If you don't use this parameter, the default value `5.7.1` is used. <br/> To further customize the NDR (for example, multiple languages), you need to create a custom message by using the **New-SystemMessage** cmdlet. <br/> |
| _RejectMessageReasonText_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.DsnText  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Mailbox servers.  <br/> The _RejectMessageReasonText_ parameter specifies the explanation text that's used when the rule rejects messages. If the value contains spaces, enclose the value in quotation marks ("). <br/> You can use this parameter with the _NotifySender_ and _RejectMessageEnhancedStatusCode_ parameters to specify the custom explanation text that's used. If you don't use this parameter, the default value `Delivery not authorized, message refused` is used. <br/> To further customize the NDR (for example, multiple languages), you need to create a custom message by using the **New-SystemMessage** cmdlet. <br/> |
| _RemoveHeader_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers.  <br/> The _RemoveHeader_ parameter specifies an action that removes a header field from the message header. The value of this parameter specifies the name of the header field to remove. <br/> |
| _RemoveOME_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter is available only in the cloud-based service. <br/>  This parameter specifies an action or part of an action for the rule. <br/>  The _RemoveOME_ parameter specifies an action that removes Office 365 Message Encryption from messages and their attachments. Valid values are: <br/>  `$true`: The message and attachments are decrypted.  <br/>  `$false`: The message and attachments aren't decrypted.  <br/> |
| _RouteMessageOutboundConnector_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.OutboundConnectorIdParameter  <br/> | This parameter is available only in the cloud-based service. <br/>  This parameter specifies an action or part of an action for the rule. <br/>  The _RouteMessageOutboundConnector_ parameter specifies an action that routes messages through the specified Outbound connector in Office 365. You can use any value that uniquely identifies the connector. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  GUID <br/> |
| _RouteMessageOutboundRequireTls_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _RouteMessageOutboundRequireTls_ parameter specifies an action that uses Transport Layer Security (TLS) encryption to deliver messages outside your organization. Valid values are: <br/>  `$true`: The messages must be delivered over a TLS encrypted channel.  <br/>  `$false`: A TLS encrypted channel isn't required to deliver the messages.  <br/> |
| _RuleErrorAction_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.RuleErrorAction  <br/> | The _RuleErrorAction_ parameter specifies what to do if rule processing can't be completed on messages. Valid values are: <br/>  `Ignore`: The message is sent anyway. This is the default value.  <br/>  `Defer`: The message is deferred so the rules engine can attempt to process the message again.  <br/> |
| _RuleSubType_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.RuleSubType  <br/> | The _RuleSubType_ parameter specifies the rule type. Valid values are: <br/>  `Dlp`: The rule is associated with a DLP policy.  <br/>  `None`: The rule is a regular rule that isn't associated with a DLP policy.  <br/> |
| _SCLOver_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SclValue  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers. <br/>  The _SCLOver_ parameter specifies a condition that looks for the SCL value of messages. Valid values are: <br/>  `-1`: The message is from a trusted sender, so the message bypasses spam filtering.  <br/>  Integers `0` through `9`: A higher value indicates that a message is more likely to be spam.  <br/>  The rule looks for messages with an SCL value that's greater than or equal to the specified value. <br/> |
| _SenderADAttributeContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SenderADAttributeContainsWords_ parameter specifies a condition that looks for words in Active Directory attributes of message senders. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Word"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Word1,Phrase with spaces,word2...","AttributeName2:Word3,Phrase with spaces,word4...`. Don't use words with leading or trailing spaces.  <br/>  For example, `"City:San Francisco,Palo Alto"` or `"City:San Francisco,Palo Alto"`, `"Department:Sales,Finance"`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _SenderADAttributeMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SenderADAttributeMatchesPatterns_ parameter specifies a condition that looks for text patterns in Active Directory attributes of message senders by using regular expressions. <br/>  You can check against any of the following Active Directory attributes: <br/> **City** <br/> **Company** <br/> **Country** <br/> **CustomAttribute1 - CustomAttribute15** <br/> **Department** <br/> **DisplayName** <br/> **Email** <br/> **FaxNumber** <br/> **FirstName** <br/> **HomePhoneNumber** <br/> **Initials** <br/> **LastName** <br/> **Manager** <br/> **MobileNumber** <br/> **Notes** <br/> **Office** <br/> **OtherFaxNumber** <br/> **OtherHomePhoneNumber** <br/> **OtherPhoneNumber** <br/> **PagerNumber** <br/> **PhoneNumber** <br/> **POBox** <br/> **State** <br/> **Street** <br/> **Title** <br/> **UserLogonName** <br/> **ZipCode** <br/>  This parameter uses the syntax: `"AttributeName:Regular Expression"`. To specify multiple attributes, or multiple words for the same attribute, use the following syntax:  `"AttributeName1:Regular Expression1,Regular Expression2...","AttributeName2:Regular Expression3,Regular Expression4..."`.  <br/>  When you specify multiple attributes, or multiple values for the same attribute, the **or** operator is used. <br/> |
| _SenderAddressLocation_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.SenderAddressLocation  <br/> | The _SenderAddressLocation_ parameter specifies where to look for sender addresses in conditions and exceptions that examine sender email addresses. Valid values are: <br/>  `Header`: Only examine senders in the message headers (for example, the **From**, **Sender**, or **Reply-To** fields). This is the default value, and is the way rules worked before Exchange 2013 Cumulative Update 1 (CU1). <br/>  `Envelope`: Only examine senders from the message envelope (the **MAIL FROM** value that was used in the SMTP transmission, which is typically stored in the **Return-Path** field). <br/>  `HeaderOrEnvelope`: Examine senders in the message header and the message envelope.  <br/>  Note that message envelope searching is only available for the following conditions and exceptions: <br/> _From_ and _ExceptIfFrom_ <br/> _FromAddressContainsWords_ and _ExceptIfFromAddressContainsWords_ <br/> _FromAddressMatchesPatterns_ and _ExceptIfFromAddressMatchesPatterns_ <br/> _FromMemberOf_ and _ExceptIfFromMemberOf_ <br/> _SenderDomainIs_ and _ExceptIfSenderDomainIs_ <br/> |
| _SenderDomainIs_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is only available on Mailbox servers.  <br/> The _SenderDomainIs_ parameter specifies a condition that looks for senders with email address in the specified domains. You can specify multiple domains separated by commas. <br/> If you want to look for sender email addresses that  *contain*  the specified domain (for example, any subdomain of a domain), use the _FromAddressMatchesPatterns_ parameter, and specify the domain by using the syntax `'@domain\.com$'`.  <br/> You can use _SenderAddressLocation_ parameter to specify where to look for the sender's email address (message header, message envelope, or both). <br/> |
| _SenderInRecipientList_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _SenderIpRanges_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.MultiValuedProperty  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SenderIpRanges_ parameter specifies a condition that looks for senders whose IP addresses matches the specified value, or fall within the specified ranges. Valid values are: <br/> **Single IP address**: For example,  `192.168.1.1`.  <br/> **IP address range**: For example,  `192.168.0.1-192.168.0.254`.  <br/> **Classless InterDomain Routing (CIDR) IP address range**: For example,  `192.168.0.1/25`.  <br/>  You can specify multiple IP addresses or ranges separated by commas. <br/> |
| _SenderManagementRelationship_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ManagementRelationship  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SenderManagementRelationship_ parameter specifies a condition that looks for the relationship between the sender and recipients in messages. Valid values are: <br/>  `Manager`: The sender is the manager of a recipient.  <br/>  `DirectReport`: A recipient is the manager of the sender.  <br/> |
| _SentTo_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SentTo_ parameter specifies a condition that looks for recipients in messages. You can use any value that uniquely identifies the recipient. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  Display name <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> |
| _SentToMemberOf_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.RecipientIdParameter[]  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SentToMemberOf_ parameter specifies a condition that looks for messages sent to members of groups. You can use any value that uniquely identifies the group. For example: <br/>  Name <br/>  Distinguished name (DN) <br/>  Display name <br/>  Email address <br/>  GUID <br/>  To enter multiple values, use the following syntax: `<value1>,<value2>,...<valueX>`. If the values contain spaces or otherwise require quotation marks, use the following syntax:  `"<value1>","<value2>",..."<valueX>"`.  <br/> > [!NOTE]>  If you remove the group after you create the rule, no action is taken on messages that are sent to members of the group.          |
| _SentToScope_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.ToUserScope  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _SentToScope_ parameter specifies a condition that looks for the location of recipients. Valid values are: <br/>  `InOrganization`: The recipient is a mailbox, mail user, group, or mail-enabled public folder in your organization **or** the recipient's email address is in an accepted domain that's configured as an authoritative domain or an internal relay domain, **and** the message was sent or received over an authenticated connection. <br/>  `NotInOrganization`: The recipients are outside your organization. The recipient's email address isn't in an accepted domain **or** the recipient's email address is in an accepted domain that's configured as an external relay domain. <br/>  `ExternalPartner`: The recipients are in a partner organization where you've configured Domain Security (mutual TLS authentication) to send mail. This value is only available in on-premises Exchange.  <br/>  `ExternalNonPartner`: The recipients are external to your organization, and the organization isn't a partner organization. This value is only available in on-premises Exchange.  <br/> |
| _SetAuditSeverity_ <br/> |Optional  <br/> |System.String  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is only available on Mailbox servers. <br/>  The _SetAuditSeverity_ parameter specifies an action that sets the severity level of the incident report and the corresponding entry that's written to the message tracking log when messages violate DLP policies. Valid values are: <br/>  `DoNotAudit`: No audit entry is logged.  <br/>  `Low`: The audit entry is assigned low severity.  <br/>  `Medium`: The audit entry is assigned medium severity.  <br/>  `High`: The audit entry is assigned high severity.  <br/> |
| _SetHeaderName_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderName  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers.  <br/> The _SetHeaderName_ parameter specifies an action that adds or modifies a header field in the message header. The value of this parameter is the name of the header field that you want to add or modify. When you use this parameter, you also need to use the _SetHeaderValue_ parameter to specify a value for the header. <br/> |
| _SetHeaderValue_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.HeaderValue  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers.  <br/> The _SetHeaderValue_ parameter specifies an action that adds or modifies a header field in the message header. The value of this parameter is the value that you want to apply to the header field. When you use this parameter, you also need to use the _SetHeaderName_ parameter to specify the name of the header field that you want to add or modify.. <br/> |
| _SetSCL_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.SclValue  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _SetSCL_ parameter specifies an action that adds or modifies the SCL value of messages. Valid values are: <br/>  `-1`: The message is from a trusted sender, so the message bypasses spam filtering.  <br/>  Integers `0` through `9`: A higher value indicates that a message is more likely to be spam.  <br/> |
| _SmtpRejectMessageRejectStatusCode_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.RejectStatusCode  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Edge Transport servers.  <br/> The _SmtpRejectMessageRejectStatusCode_ parameter specifies an action that disconnects the sending server from the Edge Transport server. The value of this parameter is the SMTP code that's used. Valid values are the integers `400` through `500`.  <br/> You can use this parameter with the _SmtpRejectMessageRejectText_ parameter. If you don't use this parameter, the default SMTP code `550` is used. <br/> |
| _SmtpRejectMessageRejectText_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.RejectText  <br/> |This parameter specifies an action or part of an action for the rule.  <br/> In on-premises Exchange, this action is only available on Edge Transport servers.  <br/> The _SmtpRejectMessageRejectText_ parameter specifies an action that disconnects the sending server from the Edge Transport server. The value of this parameter is the explanation text that's used. If the value contains spaces, enclose the value in quotation marks ("). <br/> You can use this parameter with the _SmtpRejectMessageRejectStatusCode_ parameter. If you don't use this parameter, the default text `Delivery not authorized, message refused` is used. <br/> |
| _StopRuleProcessing_ <br/> |Optional  <br/> |System.Boolean  <br/> | This parameter specifies an action or part of an action for the rule. <br/>  In on-premises Exchange, this action is available on Mailbox servers and Edge Transport servers. <br/>  The _StopRuleProcessing_ parameter specifies an action that stops processing more rules. Valid values are: <br/>  `$true`: Stop processing more rules.  <br/>  `$false`: Continue processing more rules after this one.  <br/> |
| _SubjectContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _SubjectContainsWords_ parameter specifies a condition that looks for words in the **Subject** field of messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _SubjectMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _SubjectMatchesPatterns_ parameter specifies a condition that looks for text patterns in the **Subject** field of messages by using regular expressions. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _SubjectOrBodyContainsWords_ <br/> |Optional  <br/> |Microsoft.Exchange.Data.Word[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _SubjectOrBodyContainsWords_ parameter specifies a condition that looks for words in the **Subject** field or body of messages. <br/> To specify multiple words or phrases, this parameter uses the syntax:  `Word1,"Phrase with spaces",word2,...`. Don't use leading or trailing spaces.  <br/> |
| _SubjectOrBodyMatchesPatterns_ <br/> |Optional  <br/> |Microsoft.Exchange.MessagingPolicies.Rules.Tasks.Pattern[]  <br/> |This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/> In on-premises Exchange, this condition is available on Mailbox servers and Edge Transport servers.  <br/> The _SubjectOrBodyMatchesPatterns_ parameter specifies a condition that looks for text patterns in the **Subject** field or body of messages. You can specify multiple text patterns by using the following syntax: `"<regular expression1>","<regular expression2>",...`.  <br/> |
| _UseLegacyRegex_ <br/> |Optional  <br/> |System.Boolean  <br/> | The _UseLegacyRegex_ parameter specifies whether the rule uses regular expression syntax that's compatible with Exchange Server 2010. Valid values are: <br/>  `$true`: Regular expression syntax that's compatible with Exchange 2010.  <br/>  `$false`: Regular expression syntax that's compatible with Exchange 2013 or later.  <br/> |
| _WhatIf_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The _WhatIf_ switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch. <br/> |
| _WithImportance_ <br/> |Optional  <br/> |Microsoft.Exchange.Management.Tasks.Importance  <br/> | This parameter specifies a condition or part of a condition for the rule. The name of the corresponding exception parameter starts with _ExceptIf_.  <br/>  In on-premises Exchange, this condition is only available on Mailbox servers. <br/>  The _WithImportance_ parameter specifies a condition that looks for messages with the specified importance level. Valid values are: <br/>  `Low` <br/>  `Normal` <br/>  `High` <br/> |
   
## Input Types
<a name="InputTypes"> </a>

To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data. 
  
## Return Types
<a name="ReturnTypes"> </a>

To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Output Type field is blank, the cmdlet doesn't return data. 
  

