---
title: "Set-SmimeConfig"
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.date: 1/19/2018
ms.audience: ITPro
ms.topic: reference
ms.prod: exchange-server-itpro
localization_priority: Normal
ms.assetid: de357ce0-8143-4c36-8032-026292fc63f0

description: "This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other."
---

# Set-SmimeConfig

This cmdlet is available in on-premises Exchange and in the cloud-based service. Some parameters and settings may be exclusive to one environment or the other. 
  
Use the **Set-SmimeConfig** cmdlet to modify the S/MIME configuration for Microsoft Outlook on the web.
  
For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://technet.microsoft.com/library/bb123552.aspx). 
  
```
Set-SmimeConfig [-Identity <OrganizationIdParameter>] [-Confirm [<SwitchParameter>]] [-OWAAllowUserChoiceOfSigningCertificate <$true | $false>] [-OWAAlwaysEncrypt <$true | $false>] [-OWAAlwaysSign <$true | $false>] [-OWABCCEncryptedEmailForking <UInt32>] [-OWACheckCRLOnSend <$true | $false>] [-OWAClearSign <$true | $false>] [-OWACopyRecipientHeaders <$true | $false>] [-OWACRLConnectionTimeout <UInt32>] [-OWACRLRetrievalTimeout <UInt32>] [-OWADisableCRLCheck <$true | $false>] [-OWADLExpansionTimeout <UInt32>] [-OWAEncryptionAlgorithms <String>] [-OWAEncryptTemporaryBuffers <$true | $false>] [-OWAForceSMIMEClientUpgrade <$true | $false>] [-OWAIncludeCertificateChainAndRootCertificate <$true | $false>] [-OWAIncludeCertificateChainWithoutRootCertificate <$true | $false>] [-OWAIncludeSMIMECapabilitiesInMessage <$true | $false>] [-OWAOnlyUseSmartCard <$true | $false>] [-OWASenderCertificateAttributesToDisplay <String>] [-OWASignedEmailCertificateInclusion <$true | $false>] [-OWASigningAlgorithms <String>] [-OWATripleWrapSignedEncryptedMail <$true | $false>] [-OWAUseKeyIdentifier <$true | $false>] [-OWAUseSecondaryProxiesWhenFindingCertificates <$true | $false>] [-SMIMECertificateIssuingCA <Byte[]>] [-WhatIf [<SwitchParameter>]]

```

## Examples
<a name="Examples"> </a>

### Example 1

This example sets the S/MIME configuration to allow users the choice of signing the message, limits the Certificate Revocation List (CRL) retrieval time-out to 10 seconds, and specifies the 128 bit RC2 encryption algorithm.
  
```
Set-SmimeConfig -OWAAllowUserChoiceOfSigningCertificate $true -OWACRLRetrievalTimeout 10000 -OWAEncryptionAlgorithms 6602:128
```

## Detailed Description
<a name="DetailedDescription"> </a>

> [!CAUTION]
> The **Set-SmimeConfig** cmdlet can change several important parameters than can reduce the overall level of message security. Review your organization's security policy before you make any changes.> You need to be assigned permissions before you can run this cmdlet. Although this topic lists all parameters for the cmdlet, you may not have access to some parameters if they're not included in the permissions assigned to you. To find the permissions required to run any cmdlet or parameter in your organization, see [Find the permissions required to run any Exchange cmdlet](https://technet.microsoft.com/library/mt432940.aspx). 
  
## Parameters
<a name="DetailedDescription"> </a>

|**Parameter**|**Required**|**Type**|**Description**|
|:-----|:-----|:-----|:-----|
| _Confirm_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _Identity_ <br/> |Optional  <br/> |Microsoft.Exchange.Configuration.Tasks.OrganizationIdParameter  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _OWAAllowUserChoiceOfSigningCertificate_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAAllowUserChoiceOfSigningCertificate_ parameter specifies whether to allow users to select the certificate to use when they digitally sign email messages in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> |
| _OWAAlwaysEncrypt_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAAlwaysEncrypt_ parameter specifies whether all outgoing messages are automatically encrypted in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> |
| _OWAAlwaysSign_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAAlwaysSign_ parameter specifies whether all outgoing messages are automatically signed in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> |
| _OWABCCEncryptedEmailForking_ <br/> |Optional  <br/> |System.UInt32  <br/> | The _OWABCCEncryptedEmailForking_ parameter specifies how Bcc messages are encrypted in Outlook on the web. This parameter uses the following values: <br/>  0 = One encrypted message per Bcc recipient. <br/>  1 = One single encrypted message for all Bcc recipients. <br/>  2 = One encrypted message without Bcc forking. <br/>  The default value is 0. <br/> > [!NOTE]>  This setting affects the security and privacy of Outlook on the web. Consult your organization's security policy before you change this setting.          |
| _OWACheckCRLOnSend_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWACheckCRLOnSend_ parameter specifies how the certificate revocation list (CRL) check is enforced when an email message is sent in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> When this parameter is set to  `$false` and the CRL distribution point is inaccessible, Outlook on the web allows signed or encrypted messages to be sent. When this parameter is set to `$true`, Outlook on the web displays a warning dialog box and prevents signed or encrypted messages from being sent.  <br/> |
| _OWAClearSign_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAClearSign_ parameter specifies how email messages are signed in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$true`.  <br/> When this parameter is set to  `$true`, digitally signed messages are clear-signed. When this parameter is set to  `$false`, digitally signed messages are opaque-signed. Clear-signed messages are larger than opaque-signed messages, but clear-signed messages can be read in most email clients, including clients that don't support S/MIME.  <br/> |
| _OWACopyRecipientHeaders_ <br/> |Optional  <br/> |System.Boolean  <br/> |This parameter is reserved for internal Microsoft use.  <br/> |
| _OWACRLConnectionTimeout_ <br/> |Optional  <br/> |System.UInt32  <br/> |The _OWACRLConnectionTimeout_ parameter specifies the time in milliseconds that Outlook on the web waits while connecting to retrieve a single CRL as part of a certificate validation operation. <br/> Valid input for this parameter is an integer between 0 and 4294967295 ( `UInt32`). The default value is 60000 (60 seconds).  <br/> When multiple CRLs in a certificate chain must be retrieved, the time limit that's specified by this parameter applies to each connection. For example, if a certificate requires the retrieval of three CRLs, and this parameter is set to 60000 (60 seconds), each individual CRL retrieval operation has a time limit of 60 seconds. If any one of the CRLs isn't retrieved before the time limit expires, the entire operation fails. The total time limit for all the retrievals is controlled by the _OWACRLRetrievalTimeout_ parameter. <br/> |
| _OWACRLRetrievalTimeout_ <br/> |Optional  <br/> |System.UInt32  <br/> |The _OWACRLRetrievalTimeout_ parameter specifies the time in milliseconds that Outlook on the web waits to retrieve all CRLs when validating a certificate. <br/> Valid input for this parameter is an integer between 0 and 4294967295 ( `UInt32`). The default value is 10000 (10 seconds).  <br/> If all the required CRLs are not retrieved before the time limit expires, the operation fails. Suppose the retrieval of three CRLs is required, the _OWACRLConnectionTimeout_ value is set to 60000 (60 seconds), and the _OWACRLRetrievalTimeout_ is set to 120000 (2 minutes). In this example, if any individual CRL retrieval takes more than 60 seconds, the operation fails. Also, if all the CRL retrievals together take more than 120 seconds, the operation fails. <br/> |
| _OWADisableCRLCheck_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWADisableCRLCheck_ parameter enables or disables CRL checking in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`. When set to  `$true`, this parameter disables CRL checks when validating certificates. Disabling CRL checking can decrease the time that's required to validate the signatures of signed email messages, but it also validates email messages signed with revoked certificates.  <br/> |
| _OWADLExpansionTimeout_ <br/> |Optional  <br/> |System.UInt32  <br/> |The _OWADLExpansionTimeout_ parameter specifies the time in milliseconds that Outlook on the web waits when sending encrypted messages to members of a distribution group that requires expansion. <br/> Valid input for this parameter is an integer between 0 and 4294967295 ( `UInt32`). The default value is 60000 (60 seconds). If the operation doesn't complete in the time specified by this parameter, the operation fails and the message is not sent.  <br/> When sending an encrypted message to a distribution group, Exchange expands the distribution group to retrieve the encryption certificate of each recipient. While the distribution group is being expanded, the sender receives no response from Outlook on the web.  <br/> The timeout value that's specified by this parameter is applied to the expansion of each distribution group. For example, if an encrypted message is sent to three distribution group, and the value of this parameter is 60000 (60 seconds), the entire operation can take no more than 180 seconds.  <br/> |
| _OWAEncryptionAlgorithms_ <br/> |Optional  <br/> |System.String  <br/> | The _OWAEncryptionAlgorithms_ parameter specifies a list of algorithms that are used by Outlook on the web to encrypt messages. <br/>  Valid input for this parameter is a semicolon-separated list of symmetric encryption algorithm identifiers. When you use an algorithm that supports multiple key lengths, you need to specify the key length. Note that RC2 is the only supported algorithm that that offers multiple key lengths. <br/>  You can specify the object identifier (OID) of the cryptographic service provider (CSP) when using third-party CSPs. An OID must be specified together with an algorithm ID. Outlook on the web needs an algorithm ID so that it can infer how the algorithm should be used. For example, to provide a custom replacement for the 3DES algorithm, you would specify the algorithm ID of 3DES (6603) and the custom OID of the replacement algorithm by using the value `6603,<OID>`.  <br/>  The encryption algorithms, key length values, and algorithm IDs that you can use with this parameter are described in the following list: <br/>  RC2 algorithm ID: `6602` (supported key lengths are 40, 56, 64, and 128) <br/>  DES (56-bit) algorithm ID: `6601` <br/>  3DES (168-bit) algorithm ID: `6603` <br/>  AES128 algorithm ID: `660E` <br/>  AES192 algorithm ID: `660F` <br/>  AES256 algorithm ID: `6610` <br/>  This parameter uses the following syntax: `{Algorithm ID} |; [Algorithm ID] | [,Custom replacement algorithm OID] |; [Algorithm ID[:key length]]...`.  <br/>  For example, to set the encryption algorithms to 3DES, RC2-128, RC2-64, DES, and RC2-56, use the following value: `6603;6602:128;6602:64;6601;6602:56`.  <br/>  The algorithm specified by _OWAEncryptionAlgorithms_ is always used. If the parameter is not specified or is not formatted correctly, Outlook on the web uses the default value `6610` (AES256). If the encryption algorithm or minimum key length is not available on a client, Outlook on the web does not allow encryption. <br/> |
| _OWAEncryptTemporaryBuffers_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAEncryptTemporaryBuffers_ parameter specifies whether the Outlook on the web client-side temporary message storage buffers are encrypted. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$true`.  <br/> By default, all client-side temporary buffers that store message data are encrypted using an ephemeral key and the 3DES algorithm. Setting this parameter to  `$false` disables temporary buffer encryption. <br/> > [!NOTE]> Disabling encryption of the buffers can increase performance of the Outlook on the web client but also leaves information unencrypted in the client's buffer. Consult your organization's security policy before you disable this feature.           |
| _OWAForceSMIMEClientUpgrade_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAForceSMIMEClientUpgrade_ parameter specifies whether or not users are forced to upgrade an S/MIME control that's older than their current version in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$true`.  <br/> If the parameter is set to  `$true`, users need to download and install the new control before they can use S/MIME. If this parameter is set to  `$false`, users receive a warning if the S/MIME control on their computer is not current, but they can still use S/MIME without updating the control.  <br/> |
| _OWAIncludeCertificateChainAndRootCertificate_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAIncludeCertificateChainAndRootCertificate_ parameter specifies whether the certificate chains and root certificates of the signing or encryption certificates are included in the message in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default value is  `$false`.  <br/> |
| _OWAIncludeCertificateChainWithoutRootCertificate_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAIncludeCertificateChainWithoutRootCertificate_ parameter specifies whether the certificate chains of the signing or encryption certificates are included in messages in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$false`.  <br/> By default, Outlook on the web includes only the signing and encrypting certificates, not their corresponding certificate chains. When this parameter is set to  `$true`, signed or encrypted messages include the full certificate chain, but not the root certificate.  <br/> |
| _OWAIncludeSMIMECapabilitiesInMessage_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAIncludeSMIMECapabilitiesInMessage_ parameter specifies whether signed and encrypted messages in Outlook on the web include attributes that describe the supported encryption and signing algorithms. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$false`.  <br/> Enabling this option increases the size of messages, but may make it easier for some email clients to interact with encrypted messages in Outlook on the web.  <br/> |
| _OWAOnlyUseSmartCard_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAOnlyUseSmartCard_ parameter specifies whether smartcard-based certificates are required for Outlook on the web message signing and decryption. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$false` <br/> When this parameter is set to  `$true`, the use of smartcard-based certificates for signing and decryption is required when you use Outlook on the web and the S/MIME control.  <br/> |
| _OWASenderCertificateAttributesToDisplay_ <br/> |Optional  <br/> |System.String  <br/> |The _OWASenderCertificateAttributesToDisplay_ parameter controls which certificate attributes are displayed when signature verification proceeds despite a mismatch between the sender's email address and the email address in sender's certificate. <br/> The parameter accepts a comma-separated list of object identifiers (OIDs). This setting is blank ( `$null`) by default.  <br/> |
| _OWASignedEmailCertificateInclusion_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWASignedEmailCertificateInclusion_ parameter specifies whether the sender's encryption certificate is excluded from a signed email message in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$true`.  <br/> By default, Outlook on the web and the S/MIME control include both signing and encrypting certificates with signed email messages. When this parameter is set to  `$false`, the size of encrypted messages is reduced. However, recipients don't have access to the sender's encryption certificate in the message. Recipients need to retrieve the certificate from a directory, or from the sender.  <br/> |
| _OWASigningAlgorithms_ <br/> |Optional  <br/> |System.String  <br/> | The _OWASigningAlgorithms_ parameter specifies the list of signing algorithms that are used by Outlook on the web to sign messages with the S/MIME control. <br/>  Valid input for this parameter is a semicolon-separated list of symmetric encryption algorithm identifiers. <br/>  You can specify the object identifier (OID) of the cryptographic service provider (CSP) when using third-party CSPs. An OID must be specified together with an algorithm ID. Outlook on the web needs an algorithm ID so that it can infer how the algorithm should be used. For example, to provide a custom replacement for the SHA1 algorithm, you would specify the algorithm ID of SHA1 ( `8804`) and the custom OID of the replacement algorithm by using the value  `8804,<OID>`.  <br/>  This parameter supports the following algorithms. <br/> **CALG_SHA_512**: Type: 512 bit secure hashing algorithm (SHA). Algorithm ID:  `800E`.  <br/> **CALG_SHA_384**: Type: 384 bit SHA. Algorithm ID:  `800D`.  <br/> **CALG_SHA_256**: Type: 256 bit SHA. Algorithm ID:  `800C`.  <br/> **SHA1**: Type: SHA. Algorithm ID:  `8004`.  <br/> **CALG_MD5**: Type: MD5 hashing algorithm. Algorithm ID:  `8003`.  <br/>  This parameter uses the syntax `{Algorithm ID} |; [Algorithm ID] | [,Custom replacement algorithm OID] |; [Algorithm ID[:key length]] ...`.  <br/>  For example, to set the signing algorithms to CALG_SHA_512, SHA1, and CALG_MD5, use the value `800E;8004;8003`.  <br/>  The algorithm specified by _OWASigningAlgorithms_ is always used. If this parameter is not specified or is not formatted correctly, Outlook on the web defaults to `8004` (SHA1). <br/> |
| _OWATripleWrapSignedEncryptedMail_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWATripleWrapSignedEncryptedMail_ parameter specifies whether signed and encrypted email messages in Outlook on the web are triple-wrapped. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$false`.  <br/> A triple-wrapped message is a signed message that is encrypted, and then the encrypted message is signed (signed-encrypted-signed). When this parameter is set to `$false`, the signed message is encrypted only (there is no additional signing of the encrypted message). Triple-wrapped messages offer the highest level of security for messages under the S/MIME standard, but are larger in size.  <br/> |
| _OWAUseKeyIdentifier_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAUseKeyIdentifier_ parameter specifies whether a certificate's key identifier is used to encode the asymmetrically encrypted token in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$false`.  <br/> By default, Outlook on the web encodes the asymmetrically encrypted token (sometimes called a lockbox) that's required to decrypt the rest of the message by indicating the issuer and serial number of each recipient's certificate. The issuer and serial number can then be used to locate the certificate and private key for decrypting the message.  <br/> This parameter causes the use of a certificate's key identifier when encoding the asymmetrically encrypted token. Because a key pair can be reused in new certificates, using the key identifier for encrypted email messages means that users need to keep only the most recent certificate and associated private key, rather than all old certificates. Because some email clients do not support finding certificates with a key identifier, Outlook on the web uses the issuer and serial number of each recipient's certificate by default.  <br/> |
| _OWAUseSecondaryProxiesWhenFindingCertificates_ <br/> |Optional  <br/> |System.Boolean  <br/> |The _OWAUseSecondaryProxiesWhenFindingCertificates_ parameter specifies whether alternative proxies are used during the certificate search in Outlook on the web. <br/> Valid input for this parameter is  `$true` or `$false`. The default is  `$true`.  <br/> Outlook on the web attempts to find the correct certificate for a recipient when sending encrypted messages. The certificate subject or subject alternative name values can each contain an email address. Because a recipient can have multiple proxy addresses, the certificate's subject or subject alternative name values may not match the recipient's primary SMTP address. When this parameter is set to  `$true`, and the certificate subject or subject alternative name values do not match the recipient's primary SMTP address, Outlook on the web tries to match the certificate's subject to one of the recipient's proxy addresses.  <br/> |
| _SMIMECertificateIssuingCA_ <br/> |Optional  <br/> |System.Byte[]  <br/> |The _SMIMECertificateIssuingCA_ parameter specifies the serialized certificate store (SST) that contains the Certificate Authority (CA) signing and intermediate certificate information. <br/> You need to read the file to a byte-encoded object using the **Get-Content** cmdlet. For example: `-SMIMECertificateIssuingCA $([byte[]](Get-Content -Encoding byte -Path "C:\Temp\CACertificateSerializedStore.sst" -ReadCount 0)` <br/> Each certificate is checked, and if any certificates are expired, the operation will fail.  <br/> |
| _WhatIf_ <br/> |Optional  <br/> |System.Management.Automation.SwitchParameter  <br/> |The _WhatIf_ switch simulates the actions of the command. You can use this switch to view the changes that would occur without actually applying those changes. You don't need to specify a value with this switch. <br/> |
   
## Input Types
<a name="InputTypes"> </a>

To see the input types that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Input Type field for a cmdlet is blank, the cmdlet doesn't accept input data. 
  
## Return Types
<a name="ReturnTypes"> </a>

To see the return types, which are also known as output types, that this cmdlet accepts, see [Cmdlet Input and Output Types](http://go.microsoft.com/fwlink/p/?linkId=616387). If the Output Type field is blank, the cmdlet doesn't return data. 
  

